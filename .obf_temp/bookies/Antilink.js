function a0f(a,b){const c=a0e();return a0f=function(d,e){d=d-0xf2;let f=c[d];if(a0f['PRLlZS']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0f['WmnqED']=g,a=arguments,a0f['PRLlZS']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a0f['WmnqED'](f),a[i]=f):f=j,f;},a0f(a,b);}(function(a,b){const M=a0f,c=a();while(!![]){try{const d=-parseInt(M(0xfd))/0x1*(parseInt(M(0x11c))/0x2)+-parseInt(M(0x160))/0x3+-parseInt(M(0x112))/0x4*(parseInt(M(0xfc))/0x5)+-parseInt(M(0x11b))/0x6*(-parseInt(M(0xfe))/0x7)+parseInt(M(0x10e))/0x8*(parseInt(M(0x195))/0x9)+-parseInt(M(0x1a0))/0xa*(parseInt(M(0x114))/0xb)+-parseInt(M(0x164))/0xc*(-parseInt(M(0x111))/0xd);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0e,0xdaecc));const a0t=a0b;(function(f,g){const N=a0f,h=a0b,i=f();while(!![]){try{const j=parseInt(h(0x1d1))/0x1+parseInt(h(0x1bb))/0x2*(-parseInt(h(0x204))/0x3)+parseInt(h(0x1d9))/0x4+parseInt(h(0x1fc))/0x5+parseInt(h(0x1b0))/0x6+-parseInt(h(0x1d3))/0x7+-parseInt(h(0x1c9))/0x8;if(j===g)break;else i[N(0x147)](i[N(0x191)]());}catch(k){i[N(0x147)](i[N(0x191)]());}}}(a0a,0x74bdd));import a0g from'fs';import a0h from'path';import{error,info}from'../bookieutils/logger.js';import{registerModule}from'../bookieutils/helpeutils/fonthelp.js';import{getConfig}from'../bookieutils/config.js';export const name=a0t(0x1d6)+a0t(0x1c1);export const version=a0t(0x207);registerModule(name);function a0a(){const O=a0f,a=[O(0x186)+'vm',O(0x12f)+'2e',O(0x150)+'MK',O(0x19e)+'dO',O(0x144)+'2u',O(0x1a4)+'gu',O(0x192)+'ge',O(0x17c)+'Ya',O(0x154)+'gu',O(0x168)+'sC',O(0x18e)+'gy',O(0x121)+'W',O(0x118)+'hq',O(0x13a)+O(0x148)+O(0x140)+O(0x166),O(0x172)+'q',O(0x165),O(0xfb)+'M4',O(0x101)+'uu',O(0x133),O(0x177),O(0x104)+'2G',O(0x19b)+'u4',O(0x14f)+'vq',O(0x13f)+'a',O(0x12c)+O(0x149)+O(0x19c),O(0x12e),O(0x18c)+'w0',O(0x132),O(0x18f)+'00',O(0x187),O(0x120),O(0x137)+'Mu',O(0x157)+'gu',O(0x116)+'xi',O(0x188)+'Ya',O(0x15f)+'2q',O(0x182),O(0x10d)+'q',O(0x1a7)+O(0x124)+O(0x15a)+O(0x174),O(0x16f)+'2u',O(0x10b)+'w4',O(0x142)+'v8',O(0x136)+'sa',O(0x14c)+'3q',O(0x198),O(0x175)+'W',O(0x14e)+O(0x12b)+O(0x117)+'S',O(0x193)+'Ia',O(0x11f)+O(0x127)+O(0x141)+'J',O(0x13e)+'3i',O(0x102)+O(0xf9)+'q',O(0x100)+'wW',O(0x16c)+'wq',O(0x16b),O(0x108)+O(0x197)+O(0x179)+O(0x110),O(0x15b)+'LK',O(0x13c),O(0x185)+'q',O(0x190)+'W',O(0xf7)+'wu',O(0x192)+'hK',O(0x151)+'tG',O(0x13d)+'MO',O(0x153)+'q',O(0x1a1)+'3m',O(0x12d)+'2W',O(0x131)+'3q',O(0x199)+'gu',O(0x103)+'wu',O(0x107)+'2G',O(0x155)+O(0xf8),O(0x178)+'vq',O(0x126)+'xi',O(0x146)+'24',O(0x14d)+'hi',O(0x17a)+'f8',O(0x134)+'00',O(0x16d)+'a',O(0x180)+O(0x19d),O(0x128)+'gy',O(0x18a)+'wW',O(0x113)+'Ji',O(0x17e),O(0x13b)+'xq',O(0x169),O(0x171)+'0u',O(0x14a),O(0x125)+'wq',O(0x139)+'KK',O(0x176)+O(0x18d)+O(0x17b)+O(0xf3),O(0x173)+'wW',O(0x1a5),O(0x134)+'1e',O(0x15d)+'v8',O(0x184)+'gu',O(0xf4)+'JO',O(0x143),O(0x162)+O(0xf5)+'LH',O(0x115),O(0x1a3)+'a',O(0x17f)+'Ji',O(0x159),O(0x1a2),O(0x11a)+'ey',O(0x129)+'3K',O(0x122)+'Mm',O(0x135)+'gu',O(0x15c)+'KW',O(0x15e)+'vi',O(0x196)+'uW',O(0x194)+'wW',O(0x106)+'q',O(0x10a)+'hu',O(0x10f),O(0x109)+'xq',O(0x14b)+'Ke',O(0xfa)+'Me',O(0x152)+'s8',O(0x105)+'gK',O(0x119)+'3m',O(0x158)+'Mu',O(0x123)+'sa'];return a0a=function(){return a;},a0a();}const DATA_FILE=a0h[a0t(0x1e4)+'ve'](a0t(0x19e)+a0t(0x1f3)+a0t(0x1e1)+a0t(0x1c7));function a0b(d,e){const f=a0a();return a0b=function(k,l){const P=a0f;k=k-0x191;let m=f[k];if(a0b[P(0x12a)+'h']===undefined){var n=function(v){const Q=P,w=Q(0x167)+Q(0x156)+Q(0x181)+Q(0x130)+Q(0x1a6)+Q(0x10c)+Q(0x138)+Q(0x19a)+Q(0x16e)+Q(0x18b)+Q(0x163)+Q(0x145)+Q(0xf2);let x='',y='';for(let z=0x0,A,B,C=0x0;B=v[Q(0xf6)+'t'](C++);~B&&(A=z%0x4?A*0x40+B:B,z++%0x4)?x+=String[Q(0x161)+Q(0x16a)+'de'](0xff&A>>(-0x2*z&0x6)):0x0){B=w[Q(0x189)+'Of'](B);}for(let D=0x0,E=x[Q(0x11e)+'h'];D<E;D++){y+='%'+('00'+x[Q(0x19f)+Q(0x170)](D)[Q(0x183)+Q(0x17d)](0x10))[Q(0xff)](-0x2);}return decodeURIComponent(y);};a0b[P(0x11d)+'k']=n,d=arguments,a0b[P(0x12a)+'h']=!![];}const o=f[0x0],p=k+o,q=d[p];return!q?(m=a0b[P(0x11d)+'k'](m),d[p]=m):m=q,m;},a0b(d,e);}let globalBot=null;const warnMap=loadWarnMap(),exprState=new Map(),LINK_WINDOW_MS=0x18*0x3c*0x3c*0x3e8;function a0e(){const R=['q012v0i','rdjMwui','AwD6see','mtm0mu9myLjwqq','Cxu1Dxm','sMfxBMC','EMD2wG','qZnYseq','sKTmtu4','CxvYBNm','CMjXCq','n0LWAwe','ENHYthO','y2HHCKm','mJKWDhblCvPd','ENuXtem','Eu12wq','Etjiseq','rdnQueq','EJj2ma','Dxz3EhK','BxrLng0','odKRlZ0','vurX','q05QvKm','zZLMCMG','y2HHCKe','qK1dr0i','zvHqqKC','wwjUrhG','EMDmwui','rhHUtem','ndvcwvLUvgC','mxPbBxzbrW','n2HqwvbUzq','C2XPy2u','CxC1mee','DeTerNq','ogORDuG','AwHYuei','EtjMmhK','qND2vuq','EJjmtuu','qxDUmhe','BvPXmg0','ENC1mee','qxC1sKi','qZnYwue','EKfcq0q','qZjmnNO','ntC4nJriyun5tKe','qxD2wG','vNvx','ntjdv3DPuLG','mtqZnJrcDuTgwMG','qJnevxy','nJCYmtq0ELvLB2T3','qZj2ma','EtjythK','yNnZzte','AwC1teu','AwCXtem','q012shO','oty3mtuZogvTAunwrW','ndK5mJqYC3LvA2P3','tLPJzhy','BgvUz3q','Bxr1wg4','qxC1uG','qtj2num','qZfUnui','DhH2mhO','wMLzB2q','ExDmu3O','qNDus0e','Dgfyqu4','qxC5vwK','qxDythu','ELzhzM8','zeS0D04','BxrHng4','q012wKi','ExDYsW','qND2wKm','ChfYC3q','qMD2vxO','ENDXrW','ExDeta','C3u5B3G','qxC1uMK','qZjMmNO','CNHiv0m','ruzhseK','DJbMC3q','BxrXng4','EMD2u3O','EMrprW','qxC1uMW','EK1yvKi','AwDmvwK','wdn5mxO','DMndtvG','DNv2DNi','qK05mW','qZnUshO','mZq1nJC','qZnUuei','ChvZAa','DhLxBKS','zKrLq04','ExHIua','EdbYzNi','ENHiuem','q012wKq','BMrTmM0','CMz2C3e','DJjMwui','rhHYtwW','EMDMmhK','qZi5vhO','CK1Muei','nfaYBwK','zMDOAwO','EK1Muei','qMDxr3K','EgnXwa','seL1teG','CNvYrNe','CNu1yNe','Dhz2Dxi','C3u1Dxi','DhDMwue','ndy1ndGXmKTWD1zjAW','zNjVBum','BNr1wui','wvOWmti','ntqZnZKWog9YreTrBG','rhHQuW','Bevh','ywjJzgu','AwHmvKq','qwDMwG','AgfYq28','DNvyDq','EJj2rKe','ENDXnMK','t1bruLm','q2DMwum','B2rLqxq','DtfUyNi','rgHmv3O','qvLIs3O','mhzmzq','qMDmvue','BuP5m20','rxC1sG','CMv2Bxi','BLP1tMi','rgD2neq','yNPYzxO','DgDmvue','Aw5N','C3u1Ba','Bxm0mgW','nfbrrZC','A2XTBM8','qZi5vq','Dg9tDhi','AwCXmuq','EK5QvKi','CK1mu3O','ExCXta','EMnImei','Aw5KzxG','ExC1mee','vfvwv1G','ExHYBNO','DeTxBwy','ExDetgK','DKTMBxG','DtnmvxK','C2HPzNq'];a0e=function(){return R;};return a0e();}function escapeMarkdownV2(b){const c=a0t;return b[c(0x1a9)+'ce'](/([_*\[\]()~`>#+=|{}.!-])/g,c(0x208));}function loadWarnMap(){const a=a0t;if(!a0g[a(0x1ce)+a(0x192)](DATA_FILE))return{};try{return JSON[a(0x1ca)](a0g[a(0x20a)+a(0x191)+'nc'](DATA_FILE,a(0x1e0)))||{};}catch{return{};}}function saveWarnMap(){const b=a0t;try{a0g[b(0x1eb)+b(0x1dd)](a0h[b(0x19d)+'me'](DATA_FILE),{'recursive':!![]}),a0g[b(0x1a8)+b(0x1a3)+b(0x1b6)](DATA_FILE,JSON[b(0x1cb)+b(0x198)](warnMap,null,0x2));}catch(c){error(b(0x1ab)+b(0x1c5)+b(0x1cd)+b(0x1d2)+b(0x1e6)+':\x20'+c[b(0x1a4)+'ge']);}}function recordWarn(c,d){const e=a0t;if(!warnMap[c])warnMap[c]={};warnMap[c][d]=Date[e(0x203)](),saveWarnMap();}function clearWarn(c,d){const e=a0t;if(warnMap[c]){delete warnMap[c][d];if(Object[e(0x1ae)](warnMap[c])[e(0x1e5)+'h']===0x0)delete warnMap[c];saveWarnMap();}}function isWarnedRecently(d,e){const f=a0t,g=warnMap[d]?.[e];return g&&Date[f(0x203)]()-g<LINK_WINDOW_MS;}function getNextExpression(e){const f=a0t,{EXPRESSIONS:g}=getConfig()[f(0x196)+f(0x1f5)];if(!g||g[f(0x1e5)+'h']===0x0)return'';if(!exprState[f(0x1f7)](e))exprState[f(0x205)](e,new Set());const h=exprState[f(0x1fe)](e);if(h[f(0x1c8)]>=g[f(0x1e5)+'h'])h[f(0x1c4)]();for(let i=0x0;i<g[f(0x1e5)+'h'];i++){if(!h[f(0x1f7)](i))return h[f(0x1bc)](i),g[i];}return g[0x0];}function isAdmin(b){const c=a0t;try{return b[c(0x1dc)]&&getConfig()[c(0x1b8)+'S'][c(0x199)+c(0x1cf)](b[c(0x1dc)]['id']);}catch{return![];}}export async function initialize(b){globalBot=b;}export async function onMessage(s){const t=a0t;try{const u=getConfig()[t(0x196)+t(0x1f5)];if(!u[t(0x194)+t(0x1da)+t(0x19c)+t(0x1d8)]||isAdmin(s))return;const v=s[t(0x1a4)+'ge']?.[t(0x19b)+t(0x19a)]||[];if(!v[t(0x1e2)](E=>[t(0x1b2),t(0x1ee)+t(0x1d0),t(0x1ee)+t(0x19f)+'on'][t(0x199)+t(0x1cf)](E[t(0x1b1)])))return;const w=s[t(0x206)]['id'],x=s[t(0x1dc)]['id'],y=s[t(0x1dc)][t(0x1b3)+t(0x1c0)]?'@'+s[t(0x1dc)][t(0x1b3)+t(0x1c0)]:''+x,z=escapeMarkdownV2('('+y+(t(0x1af)+t(0x1e7)+t(0x1ac)+t(0x1a1)+t(0x201)+'d)')),A=escapeMarkdownV2('('+y+')');try{await s[t(0x1f9)][t(0x1f6)+t(0x1e3)+t(0x1b5)](w,s[t(0x1a4)+'ge'][t(0x1a4)+t(0x1d7)]),info(t(0x1e9)+t(0x1fd)+t(0x1a6)+'\x20'+s[t(0x1a4)+'ge'][t(0x1a4)+t(0x1d7)]);}catch(E){error(t(0x1aa)+t(0x1f6)+t(0x1f2)+t(0x1fa)+':\x20'+E[t(0x1a4)+'ge']);}if(!isWarnedRecently(w,x)){const F=t(0x1f1)+escapeMarkdownV2(u[t(0x1fb)+t(0x1b4)+t(0x1f8)])+'\x20'+z;try{const G=await s[t(0x1df)](F,{'parse_mode':t(0x1c6)+t(0x1f4)});setTimeout(()=>{const H=t;globalBot[H(0x1f9)][H(0x1f6)+H(0x1e3)+H(0x1b5)](w,G[H(0x1a4)+H(0x1d7)])[H(0x1b7)](()=>{});},u[t(0x1ea)+t(0x1ff)+t(0x1cc)+t(0x195)+t(0x1bf)+'S']);}catch(H){error(t(0x1a5)+t(0x1de)+t(0x1a7)+t(0x197)+t(0x1f0)+H[t(0x1a4)+'ge']);}recordWarn(w,x);return;}const B=getNextExpression(w),D=escapeMarkdownV2(B)+'\x20'+A;try{const I=await s[t(0x1df)](D,{'parse_mode':t(0x1c6)+t(0x1f4)});setTimeout(()=>{const J=t;globalBot[J(0x1f9)][J(0x1f6)+J(0x1e3)+J(0x1b5)](w,I[J(0x1a4)+J(0x1d7)])[J(0x1b7)](()=>{});},u[t(0x1ea)+t(0x1ff)+t(0x1cc)+t(0x195)+t(0x1bf)+'S']);}catch(J){error(t(0x1c2)+t(0x1ec)+t(0x1a0)+t(0x1ad)+t(0x1fa)+':\x20'+J[t(0x1a4)+'ge']);}try{await s[t(0x1f9)][t(0x1ed)+t(0x1e8)+t(0x1bd)+t(0x209)](w,x,{'permissions':{'can_send_messages':![],'can_send_media_messages':![],'can_send_polls':![],'can_send_other_messages':![],'can_add_web_page_previews':![],'can_change_info':![],'can_invite_users':![],'can_pin_messages':![]},'until_date':u[t(0x200)+t(0x1b9)+t(0x1ef)+'S']>0x0?Math[t(0x1d4)](Date[t(0x203)]()/0x3e8)+Math[t(0x1d4)](u[t(0x200)+t(0x1b9)+t(0x1ef)+'S']/0x3e8):0x0}),info(t(0x1d5)+t(0x1be)+x+t(0x1ba)+w);}catch(K){error(t(0x1a2)+t(0x1c3)+t(0x1db)+K[t(0x1a4)+'ge']);}clearWarn(w,x);}catch(L){error(t(0x1d6)+t(0x193)+t(0x202)+'\x20'+L[t(0x1a4)+'ge']);}}