(function(a,b){const Y=a0d,c=a();while(!![]){try{const d=parseInt(Y(0x185))/0x1*(parseInt(Y(0x192))/0x2)+-parseInt(Y(0x131))/0x3+parseInt(Y(0x195))/0x4*(-parseInt(Y(0x248))/0x5)+parseInt(Y(0x1e6))/0x6*(-parseInt(Y(0x193))/0x7)+parseInt(Y(0x233))/0x8*(-parseInt(Y(0x26a))/0x9)+-parseInt(Y(0x23a))/0xa*(-parseInt(Y(0x268))/0xb)+-parseInt(Y(0x133))/0xc*(-parseInt(Y(0x243))/0xd);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0c,0x49fa4));const a0B=a0b;(function(f,g){const Z=a0d,h=a0b,i=f();while(!![]){try{const j=-parseInt(h(0x2aa))/0x1+-parseInt(h(0x27c))/0x2+parseInt(h(0x217))/0x3+-parseInt(h(0x163))/0x4+-parseInt(h(0x1db))/0x5*(-parseInt(h(0x237))/0x6)+-parseInt(h(0x18b))/0x7+parseInt(h(0x211))/0x8;if(j===g)break;else i[Z(0x1b2)](i[Z(0x18c)]());}catch(k){i[Z(0x1b2)](i[Z(0x18c)]());}}}(a0a,0x5540d));import{InlineKeyboard}from'grammy';function a0a(){const a0=a0d,a=[a0(0x1f8),a0(0x16a)+'wu',a0(0x242),a0(0x24c)+'00',a0(0x161)+'Ia',a0(0xf9)+'3q',a0(0x15a)+'Mu',a0(0xeb)+'Nq',a0(0x264)+'hq',a0(0x269)+'vq',a0(0x1cf)+'hi',a0(0x12f)+a0(0x258)+a0(0x14d)+a0(0x162),a0(0x1c5)+'2u',a0(0x1e0)+'xq',a0(0x1f7)+a0(0x10c)+'q',a0(0x286),a0(0x1f5)+'W',a0(0x214)+'3i',a0(0x1f9)+'sa',a0(0x28e)+'xq',a0(0x147)+'wq',a0(0x255)+'1e',a0(0x253)+'Ia',a0(0x274)+'MW',a0(0x1af)+'3u',a0(0xf3)+'ca',a0(0x1df)+'wm',a0(0x17c)+'gi',a0(0x239)+'wq',a0(0x207),a0(0xf0)+'a',a0(0x1d6)+'gG',a0(0x271)+'c8',a0(0x21a)+'G',a0(0x211)+'a',a0(0x198)+'eu',a0(0x19d)+'xm',a0(0x27b)+'f8',a0(0x291)+'28',a0(0x18f)+'Ia',a0(0x250)+'xq',a0(0x1dc),a0(0x196)+'ca',a0(0x128)+a0(0x113)+a0(0xf7),a0(0x180)+'hi',a0(0x205)+'xm',a0(0x157)+'G',a0(0x190)+'Nq',a0(0x13b)+'2G',a0(0x166)+'Ke',a0(0x181)+a0(0x1a5),a0(0x1ba)+'xu',a0(0x26c)+'Nm',a0(0x19b)+'gK',a0(0x144)+'3q',a0(0x289)+'MK',a0(0xfb)+'wi',a0(0x17a)+'q',a0(0x27e)+a0(0xfc),a0(0x138)+'xq',a0(0x151)+'hC',a0(0x1ec)+a0(0x145),a0(0x163)+'a',a0(0x1b5)+'xq',a0(0x227)+'q',a0(0x1b4)+'ha',a0(0x230)+'a',a0(0x176)+'wW',a0(0x220),a0(0x146)+a0(0x189)+'W',a0(0x234)+'gm',a0(0x10e)+a0(0x1a4)+'m',a0(0x1bd)+'wC',a0(0x187)+'eW',a0(0x237)+'w4',a0(0x13d)+'YC',a0(0x191)+'I4',a0(0x27c)+'gK',a0(0x20b)+'u4',a0(0x12e)+'G',a0(0x261)+'xi',a0(0x13e)+'ca',a0(0x235)+'sa',a0(0x150)+'fK',a0(0x241)+'tO',a0(0x1b7)+'wq',a0(0x18a)+'vi',a0(0x1ae)+'J8',a0(0x263)+'w8',a0(0x1bb)+'20',a0(0x164)+'wC',a0(0x19a)+a0(0x22f)+a0(0x14b)+'5',a0(0x1d5)+'w4',a0(0x245)+'hm',a0(0x1bc),a0(0x15d)+'xa',a0(0x15e)+'Ya',a0(0x25c)+'dS',a0(0x238)+'Ia',a0(0x26e)+'3q',a0(0x169)+'gG',a0(0x1d8)+'ge',a0(0x200)+'2u',a0(0x1db)+'Ia',a0(0x262)+'vm',a0(0x278)+'MK',a0(0x1fb)+'sa',a0(0x14c),a0(0x1c1)+'q',a0(0x135)+'w8',a0(0x20d)+'wK',a0(0x22e)+'xm',a0(0x28c),a0(0x19f)+a0(0x1c4)+'y',a0(0x177)+'K8',a0(0x23f)+'Ni',a0(0x25f)+'24',a0(0x160)+'vq',a0(0x275)+'KW',a0(0xf0)+'dO',a0(0x103)+'W',a0(0x120)+'1q',a0(0x101),a0(0x1d3)+a0(0xec)+'kO',a0(0x208)+'gG',a0(0x11b)+'M8',a0(0x114)+'ca',a0(0x272),a0(0x26d)+'cW',a0(0x25a)+'Mu',a0(0x266)+a0(0x1ef)+a0(0x280),a0(0x13d)+'2q',a0(0x217)+'ge',a0(0x1f3)+'2e',a0(0x105)+'fy',a0(0x23e)+'Ya',a0(0x20a)+'ge',a0(0x1b8)+'eu',a0(0x1a6)+'wm',a0(0x186)+'ge',a0(0x1ec)+a0(0x249),a0(0x1b3)+'hu',a0(0x21f)+'3q',a0(0x17d)+'wu',a0(0x178)+'Ia',a0(0x1be)+a0(0x1ea)+a0(0x165)+a0(0x256),a0(0x283)+'sa',a0(0x170)+'c4',a0(0x270)+'hK',a0(0x251),a0(0x226),a0(0x1fd)+a0(0x127)+a0(0xf5)+'w',a0(0x16d)+'3i',a0(0x27f)+'3q',a0(0x118)+'ge',a0(0x1d4)+'2q',a0(0x168)+'q',a0(0x228)+'xi',a0(0x121)+'MK',a0(0xea)+'2K',a0(0x1c7)+'xy',a0(0x172)+'3q',a0(0xf8)+'24',a0(0x273)+'vi',a0(0x1e4)+'0W',a0(0x20f)+'Ia',a0(0x27e)+a0(0x194),a0(0x17e)+'20',a0(0x279)+'gu',a0(0x10f)+'u4',a0(0x1eb)+'a',a0(0x202)+'ge',a0(0x1e8)+'Mu',a0(0x1cc)+a0(0x126)+'m',a0(0x110)+'c8',a0(0x1d2)+'G',a0(0xef)+'wu',a0(0x287)+'G',a0(0x125)+'u4',a0(0x140)+'uy',a0(0x1a7)+a0(0x12c)+'m',a0(0xf1)+'Jm',a0(0x246)+'W',a0(0x259)+a0(0x1fa)+'G',a0(0x22a)+'a',a0(0x1d1)+'hK',a0(0x1fc)+a0(0x13f)+a0(0x201),a0(0x1c0)+'gq',a0(0x10d)+'I8',a0(0x1e2)+'ge',a0(0x134),a0(0x1e2)+'fC',a0(0x1e3)+'wu',a0(0x23c)+'Ya',a0(0x137)+'ca',a0(0x1de)+'we',a0(0x100),a0(0x13d)+'2W',a0(0x1ee)+'M8',a0(0x24e)+'sa',a0(0x11c)+'Mq',a0(0xf4)+'gi',a0(0x1c9),a0(0x1ce)+'ca',a0(0x14a)+'q',a0(0x240)+'q',a0(0x112)+'Ia',a0(0xee)+'J0',a0(0x26f)+'wW',a0(0x13a)+'tS',a0(0x14e)+'Nu',a0(0x171)+'gu',a0(0x1ae)+'M4',a0(0x16b)+a0(0x1f0)+'e',a0(0x175)+'Me',a0(0x1e1)+'xm',a0(0x111),a0(0x1d7)+'2y',a0(0x204)+'gG',a0(0x25b)+'um',a0(0x28a)+'gu',a0(0x159),a0(0x21b)+'ee',a0(0x206)+'sa',a0(0x24d),a0(0x28f)+'JW',a0(0x108)+'Ia',a0(0x1cd),a0(0x209)+'t4',a0(0x1ec)+a0(0x1ff),a0(0x124)+'ge',a0(0x1a3)+'em',a0(0x241)+'q',a0(0x19e)+'q',a0(0x1f1)+'gG',a0(0x26b)+'wm',a0(0x1e7)+'3i',a0(0x22b)+'xa',a0(0x25d)+'Mu',a0(0x1a9)+'ui',a0(0x13c)+'xi',a0(0x254)+'M8',a0(0x1b1)+'Y8',a0(0x11a)+'c4',a0(0x1a2)+'wu',a0(0x290)+'ca',a0(0x1e5)+'W',a0(0x218)+'xq',a0(0x21e)+a0(0x22d)+'u',a0(0x20c),a0(0x1e9),a0(0x15b)+'gu',a0(0xfd)+a0(0x130)+'q',a0(0x27d)+a0(0x182)+'q',a0(0x122)+'3q',a0(0x285)+'ca',a0(0x116),a0(0x23d)+'e0',a0(0x1ed)+'sa',a0(0x276)+'f8',a0(0x1c8)+'Mu',a0(0x1ab),a0(0x156)+'xm',a0(0x25e)+'q',a0(0x244)+'xi',a0(0x1ac)+'W',a0(0x27a)+'28',a0(0x109)+'2K',a0(0x21d)+'wm',a0(0x115)+'wy',a0(0x20e),a0(0x1aa)+'xq',a0(0x15f)+'hK',a0(0x229),a0(0x149)+'M8',a0(0xe8)+'Ia',a0(0x212)+'2u',a0(0x132)+'w4',a0(0x1c3)+a0(0x158)+'y',a0(0x1dd)+'hC',a0(0x10e)+a0(0x1fe)+'a',a0(0x10b)+'wu',a0(0x1c2)+'a',a0(0x21c)+'gW',a0(0x1ad)+'wS',a0(0x225)+'wq',a0(0x267)+'Mq',a0(0x16f)+'W',a0(0xf2)+a0(0x19c),a0(0xfa)+'q',a0(0x1f9)+'q',a0(0x276)+'a',a0(0x1a0),a0(0x213)+'3q',a0(0x215)+'wu',a0(0x1f6)+'My',a0(0x1d8)+'hK',a0(0x231)+'xm',a0(0x1b6)+a0(0x153)+a0(0x152)+'j',a0(0x291)+'sa',a0(0x1f2)+'2G',a0(0x281)+'hK',a0(0x221),a0(0x161)+'G',a0(0x28b)+'fu',a0(0x260)+'xy',a0(0x106)+'a',a0(0x117)+'Ni',a0(0x28d)+'gG',a0(0x247)+'gK',a0(0x236)+'e4',a0(0x222)+'2K',a0(0xf6)+'q',a0(0x119)+'3m',a0(0x223),a0(0x173),a0(0x238)+'GO',a0(0x282)+'a',a0(0x107)+'xq',a0(0x184)+'ZK',a0(0x17f)+a0(0x1b9),a0(0x1d0),a0(0x265)+'xq',a0(0x210)+'hq',a0(0x12b)+'ge',a0(0x103)+'ZO',a0(0x12d)+'u0',a0(0x27e)+a0(0x284),a0(0x11e)+'si',a0(0x12a)+'wu',a0(0x1cb)+'xu',a0(0xfe)+a0(0x232)+a0(0x188)+a0(0x22c),a0(0x123)+a0(0x277)+a0(0x11d),a0(0x18e)+'sa',a0(0x104)+'gK',a0(0x288)+a0(0x1b0)+'m',a0(0x1f4)+'Je',a0(0x1d9)+'3u',a0(0x129)+'eS',a0(0x18d)+'gu',a0(0x1a1)+'JO',a0(0x216)+'xm',a0(0x102)+'eG',a0(0x17b)+'3C',a0(0x252)+'W',a0(0x14f)+'t4',a0(0x11f)+'ge',a0(0x199),a0(0x118)+'M8',a0(0x24e)+'v8',a0(0xed)+'Ya',a0(0x23b)+'gG',a0(0x1ca)+'wy',a0(0xe8)+'JO',a0(0x154)+'xi',a0(0x1a8),a0(0x143)+'g8',a0(0x24b)+'gu',a0(0x1bf),a0(0x197)+'a'];return a0a=function(){return a;},a0a();}import{DateTime}from'luxon';import{db}from'../bookieutils/db.js';import{getDefault,getConnection}from'../bookieutils/connection.js';import{applyFont,registerModule}from'../bookieutils/helpeutils/fonthelp.js';import{info,error}from'../bookieutils/logger.js';import{getConfig}from'../bookieutils/config.js';function a0d(a,b){const c=a0c();return a0d=function(d,e){d=d-0xe8;let f=c[d];if(a0d['POqQlW']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0d['LYkNQW']=g,a=arguments,a0d['POqQlW']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a0d['LYkNQW'](f),a[i]=f):f=j,f;},a0d(a,b);}export const name=a0B(0x220)+a0B(0x1b8)+a0B(0x291);export const version=a0B(0x168);registerModule(name);const CALLBACK_PREFIX=a0B(0x240)+a0B(0x279),TIME_ZONE=a0B(0x20a)+a0B(0x1ee)+a0B(0x24d),MAX_MESSAGES_TO_STORE=0x32,SAVE_DEBOUNCE_MS=0x3a98,USERS_PER_PAGE=0xa,TIMEFRAMES={'DAILY':a0B(0x239),'WEEKLY':a0B(0x245)+'y','MONTHLY':a0B(0x26a)+'ly','YEARLY':a0B(0x197)+'y','LAST_WEEKLY':a0B(0x23f)+a0B(0x2ad)};let activity=new Map(),botApi=null,saveTimer=null;const escapeHtml=b=>typeof b===a0B(0x1dc)+'g'?b[a0B(0x1e5)+'ce'](/&/g,a0B(0x1e1))[a0B(0x1e5)+'ce'](/</g,a0B(0x29f))[a0B(0x1e5)+'ce'](/>/g,a0B(0x289))[a0B(0x1e5)+'ce'](/"/g,a0B(0x1b6)+';')[a0B(0x1e5)+'ce'](/'/g,a0B(0x2bf)+';'):b,isAdmin=b=>{const c=a0B;try{const {ADMINS:ADMINS=[]}=getConfig();return b[c(0x1c0)]?.['id']&&Array[c(0x1f3)+'ay'](ADMINS)&&ADMINS[c(0x20d)+c(0x17b)](b[c(0x1c0)]['id']);}catch{return![];}};function getChatActivity(b){const c=a0B;return!activity[c(0x244)](b)&&activity[c(0x215)](b,{[TIMEFRAMES[c(0x1d3)]]:new Map(),[TIMEFRAMES[c(0x224)+'Y']]:new Map(),[TIMEFRAMES[c(0x16e)+'LY']]:new Map(),[TIMEFRAMES[c(0x1f6)+'Y']]:new Map(),[TIMEFRAMES[c(0x1a5)+c(0x224)+'Y']]:new Map()}),activity[c(0x2ba)](b);}async function initDatabase(){const a=a0B;await db[a(0x276)](a(0x1d1)+a(0x189)+a(0x26f)+a(0x233)+a(0x199)+a(0x1f9)+a(0x221)+a(0x214)+a(0x1bb)+a(0x210)+a(0x242)+a(0x283)+a(0x232)+a(0x1d6)+a(0x2c6)+a(0x16a)+a(0x262)+a(0x242)+a(0x192)+a(0x275)+a(0x2b6)+a(0x225)+a(0x251)+a(0x1c4));}function a0c(){const a3=['Dxz3EhK','EuO0A3y','BgnIwxO','qMD2mhO','qtjynq','qZfeueq','A3rxvKe','q0LIsKe','DtbmAhm','qNrpnG','Exm5B3K','qNDmvq','DNvyBwm','ENzYteu','C2zYBNq','qZjyuhK','EK1mwum','qMHXr3O','qxH6thq','q01MvhO','AwHxr3u','AwDUt3K','D2HLzuC','qu05uei','DuT2Cxq','q0TUsei','De04r3K','ogORDeG','AwDysem','y0LHrW','q005mW','EMm0ogW','EJj2ma','sKTmtu4','qJnQs3O','Etj2uW','EK5QvKi','CxC0r3O','ENHQwG','CgDlk2S','CgDlk3y','u3Dh','C2j4ENC','re1mvKq','DgvxC3u','Etj2uei','ExnIwxO','DhfxBwC','mteWotCZnNvcBfDiEG','rgD1r2S','CgDlk3e','DeS5DwK','AwD6vKq','Cgm5sha','EMDMmhO','mZbbuuPKrKy','AwrysgK','qvLImei','ENDYueq','qZj2wum','qxHUyKm','q005sue','qND2vuq','EMD1kW','ndu1wNPhDgHn','EtjythK','qJn2v2K','rhHHr2O','BdjMsKq','nvbQve1UqG','zurzqLC','wvOWmti','rgDmmei','Awv6C3q','qxHQva','re1mmeu','zMDOAwO','ENDMu2W','qZj2ma','q2Dymum','q05QvKm','qxHUrNK','Eu1MsKe','z3Dh','EKfcq0q','DeDABte','BuPYqxm','qZnXr3K','Dtb2Bxi','AK1Mvem','EtnYueq','rgHmv3O','qZj2sKi','ExDUmee','Bdn2wNO','CxvyDNi','q2D2wue','q05Qmum','qZnIu0e','ogOREeS','ENDUvKm','odyZodnyDgLlAfK','CtfQzNe','ouHIu3LqCq','rxnIwxO','qNDQtem','rgy5uhO','Bdjysem','ENHXr3e','qxH6ueq','DNHUtgK','ExHIua','C3u1Dhi','rxD2sem','D3v2yNu','Etjiseq','n0LWAwy','ENC1mem','qZnYseq','ENDXr3K','DgvMDhy','qwDMvem','ogORqve','nfbzzMK','DhnIshK','yM5cmJq','END2uKi','EK05wwK','q0LHohK','zKXmq1C','Awnhl2W','qK05mW','ENq0A2m','ogORDu0','EJjmvui','qMD2shO','qxH6tgK','EMDMnq','qxC0r0q','rgDmmKe','qMHYwMW','DMv2Exy','BeLHohK','Cgm5sxa','A2XTBM8','qwDMmhG','qZjiuhO','nhbxtJu','DMDiuem','qwHQthO','ENnIEhO','qMDmwKq','AwH5wMW','q1LKv04','Awu1Chy','CtjMu0i','sffYmg4','DhD2vuq','sxbPyq','q1LIsKi','qMD2vxO','rhD2wuu','ENuXtei','zwzkrge','B3rIAhC','BuPLnw4','t1bruLm','qwDMwG','ENHXsa','Dhu5B3y','qNHUtKm','qNDmu0i','rgDLugK','qZi5wuq','CMD2u3O','CNzlu2m','qxHTr0q','B2rLqxq','rgnIEhO','C2jIEtm','Au5YtM8','ogORDe4','Ctb1r3m','q011l3a','ExCXta','qxCXtgW','uffhnZC','rgD2wKq','qNC5s0e','qNDMvW','EtjUmum','ENDXr3O','END2uMO','q01mvNO','qZj2mhC','ENDetei','yLL6Cq','q012txa','AwDYseq','CNziANu','q2HQteq','ALLIvui','nffzzJC','ENDUmgK','qxDXr3m','swjTExG','zgfAqNy','CgDPkZq','CxzQEMK','Edi1sei','DMnIsKe','C2jZENG','AwzIC3m','ExHYsgW','BvPlmw4','Eerlqwu','mtm0ndi4oeLxCe1jwG','BePLr0e','ntiZmta0rwHrDgjn','CgDPkW','qxHImee','vfvwv1G','AwnHr2K','EdnUmhK','mZq1nJC','AwnHr2S','EJj2mhe','qZn2v3O','rdj2tee','y0LHr2K','n0LWAwu','Dgv1r3m','ChfYC3q','y2HHCKe','q005wwK','AK5Mmui','zw5iqKC','ogORDeK','ExHYrKe','AgfYq28','rgDLr3O','EJjmtuu','ugrYD0W','EJj2wG','CNP6mM4','qxHTr0e','y0Dpoee','CMvMANq','qJn2wMK','ugX0mdK','sKTyDMG','q01QvNK','zNjVBum','EJj1r0e','q2HXnM8','CgngsJq','EhrprW','qJnQueu','qMDxr3O','Aw5KzxG','EJnQvKq','rgDiuem','CxHQtgK','CMv2Bxi','DNHUtem','ANvh','DgDmwKq','ENHUwNK','uffcDKW','Etjisem','BwzHuem','qZjmnNO','END2uMK','AwHYuei','ogORB0G','BgvUz3q','EMD2wNK','ruzhseK','AK1ymg8','qxHqthO','qxHTr0m','DvLIshK','ENHQnq','ywjJzgu','q2HQueq','qxHYuhK','CNnIz3u','ENnHt2m','Aw5N','rgDiu0u','rgC5Bui','EtjMu0i','re1Mu0q','EdnIwui','ne9JDwK','EJj2wMK','v1ftr3e','wwjVqJm','Dg9tDhi','AKLTv20','ngXPENjkyW','rxy5wKq','qtjynwK','rfD2tvq','swj0ENC','DMv2Ahi','C2XPy2u','C2HPzNq','ExDUuMK','AwHYt3O','AwD6vKm','qZnYsem','qK1dvwW','ota5nJrnD3jVsg0','n1bnu0XZCa','zxjirge','mtmYmdqWne5LCMvPAq','De12neq','rgD2neq','DtbmAhy','qNDMna','BNrHng4','AwDMsKq','nxnm','ENHQzhK','rgHQuei','ogORDva','ENHXvq','qxHQvg8','EK5Qsei','qvLewMK','y2jUENG','twzk','CxD6wue','ogORtLu','EMD2wG','CNnIDxe','qMnIzxK','qxD2sW','AK1emg8','AwHethO','rhHUtem','AwHQtem','C2jJExC','rgDdnMW','ChvZAa','qxC1sKi','rgC5DKm','EMD2u3O','BxrTmg4','DtjMmNO','ENnIEhm','zfHjCeC','ExDUuNu','AwD6wui','q052vq','y0DqCxK','BLP1ww0','ExDyuW','ExDyu2K','Cdjms3a','q2H2wKe','qJi1wMK','C2jTqxG','ExC1wKq','odKRlZ0','CxDUmee','DMDitem','qxDXoq','DMDmvhO','EMD2txK','ogORCeG','ENDXvq','AwC1vKq','AwDmvwK','q01ynq','EMDMuei','EMDmtxO','AxbJrKO','Cgm5sKi','qZnYwue','AwDMmuq','ENC1s3q','q012v0i','qJn1r0m','y2HHCKm','DMnIChu','EJj1rW','qK12m2K','EK05wxi','DMu4r3K','q012wNO','qZjMtNO','qMDMwKq','ExDUmei','DJb2zNm','ENHithK','mZa2nZy4nNHtELfysG','ENnItui','ExHTr3K','ExDYsW','zemWBMC','ENHiueq','nfaYBwK','EJn2vwK','AJnTr0i','kYS0sLK','swj6ENC','qNC5vuq','DuT1r3K','qND2wKm','BvK0wMW','AwqWr3a','EdjUvKi','ogORCLa','BdjlkW','EMDMmhK','s3PWD0S','qMDmmNO','nfbjytC','BLP1wM0','y2jVqLK','ztvwAwe','q2DMwum','CKHbCq','EMnxr3O'];a0c=function(){return a3;};return a0c();}function rehydrateChatData(e){const f=a0B,g={};for(const h of Object[f(0x20f)+'s'](TIMEFRAMES)){const i=e[h]||[];g[h]=new Map(i[f(0x280)](([j,k])=>[Number(j),{...k,'m':new Set(k['m']||[])}]));}return g;}async function loadActivityFromDB(){const e=a0B,f=await db[e(0x17e)](e(0x25b)+e(0x2c4)+e(0x200)+e(0x172)+e(0x183)+e(0x1b5)+e(0x175)+e(0x228));activity[e(0x288)]();for(const {chat_id:g,data:h}of f){try{activity[e(0x215)](g,rehydrateChatData(JSON[e(0x1e6)](h)));}catch(i){await db[e(0x1de)](e(0x1f5)+e(0x1f2)+e(0x219)+e(0x214)+e(0x1bb)+e(0x209)+e(0x2ac)+e(0x194)+e(0x190),g),info(e(0x2be)+e(0x28a)+e(0x188)+e(0x21a)+e(0x292)+e(0x208)+'t\x20'+g);}}}function dehydrate(d){const e=a0B,f={};for(const g of Object[e(0x20f)+'s'](TIMEFRAMES)){f[g]=Array[e(0x1c0)](d[g][e(0x1e9)+'es']())[e(0x280)](([h,i])=>[h,{...i,'m':Array[e(0x1c0)](i['m'])}]);}return f;}function markChanged(){clearTimeout(saveTimer),saveTimer=setTimeout(saveAllActivityToDB,SAVE_DEBOUNCE_MS);}async function saveAllActivityToDB(){const d=a0B;for(const [e,f]of activity[d(0x1e9)+'es']()){const g=JSON[d(0x1dc)+d(0x24c)](dehydrate(f));await db[d(0x1de)](d(0x223)+d(0x1e7)+d(0x25e)+d(0x229)+d(0x19a)+d(0x193)+d(0x20b)+d(0x1c6)+d(0x21f)+d(0x22b)+d(0x206)+d(0x1e8)+d(0x27f)+'?)',e,g);}info(d(0x1d5)+d(0x1b5)+d(0x247)+d(0x2bd)+activity[d(0x21c)]+(d(0x277)+'s'));}function trackMessage(k){const l=a0B,{from:m,chat:n,message:o}=k;if(!m||m[l(0x271)+'t']||isAdmin(k))return;const p=o?.[l(0x17f)];if(!p)return;const q=getChatActivity(n['id']);for(const r of[TIMEFRAMES[l(0x1d3)],TIMEFRAMES[l(0x224)+'Y'],TIMEFRAMES[l(0x16e)+'LY'],TIMEFRAMES[l(0x1f6)+'Y']]){const s=q[r],t=s[l(0x2ba)](m['id'])||{'c':0x0,'f':m[l(0x2a5)+l(0x161)],'u':m[l(0x254)+l(0x258)],'m':new Set()};t['c']++,t['f']=m[l(0x2a5)+l(0x161)],t['u']=m[l(0x254)+l(0x258)],t['m'][l(0x27a)](p);if(t['m'][l(0x21c)]>MAX_MESSAGES_TO_STORE){const u=Array[l(0x1c0)](t['m']);u[l(0x187)](),t['m']=new Set(u);}s[l(0x215)](m['id'],t);}markChanged();}async function getPublicLeaderboard(k,l){const m=a0B,n=getChatActivity(k)[l],o=Array[m(0x1c0)](n[m(0x1e9)+'es']())[m(0x2b2)](([,v],[,w])=>w['c']-v['c'])[m(0x294)](0x0,0x19),p=l===TIMEFRAMES[m(0x224)+'Y'],q=p?m(0x1f1)+m(0x230)+m(0x1c9)+m(0x248)+m(0x2a0):m(0x22d)+m(0x299)+m(0x267)+m(0x1cd)+m(0x296),r=await applyFont(name,q),s=p?m(0x26d)+m(0x19c)+m(0x18a)+m(0x1a8)+m(0x24e)+m(0x1a0)+m(0x23d)+m(0x26e)+m(0x1a7)+m(0x21e)+m(0x1bc)+m(0x2b9)+m(0x198)+m(0x261)+m(0x180):m(0x1d2)+m(0x297)+m(0x1e4)+m(0x22c)+m(0x282)+m(0x1a0)+m(0x2b1)+m(0x26c)+m(0x165)+m(0x1ea)+m(0x25c)+m(0x17a)+m(0x2b7)+'>';if(!o[m(0x185)+'h'])return r+'\x0a\x0a'+(p?m(0x176)+m(0x1cb)+m(0x222)+m(0x1fe)+m(0x252)+m(0x201)+m(0x1b7)+m(0x1cc)+m(0x1fb):m(0x284)+m(0x246)+m(0x172)+m(0x1d9)+m(0x20e)+m(0x29c)+'.')+'\x0a\x0a'+s;const t=p?['🏆','🥈','🥉']:['🥇','🥈','🥉'],u=o[m(0x280)](([v,w],x)=>{const y=m,z=w['u']?'@'+w['u']:escapeHtml(w['f']),A=x<0x3?'\x20'+t[x]:'';return x+0x1+(y(0x2ab)+y(0x24f)+y(0x23c)+y(0x1d0)+y(0x1ec))+v+'\x22>'+z+(y(0x1e2)+y(0x2c0))+w['c']+(y(0x293)+y(0x205)+y(0x1eb))+A;});return r+'\x0a\x0a'+u[m(0x1a1)]('\x0a')+'\x0a\x0a'+s;}async function generateTimeframeMenu(e){const f=a0B,g=await botApi[f(0x1b0)+'at'](e),h=await applyFont(name,f(0x1c5)+f(0x266)+f(0x181)+f(0x274)+f(0x1a7)+f(0x23e)+escapeHtml(g[f(0x17d)])+f(0x179)),i=new InlineKeyboard()[f(0x17f)](f(0x23a)+'ly',CALLBACK_PREFIX+(f(0x1f7)+':')+e+'::'+TIMEFRAMES[f(0x1d3)])[f(0x17f)](f(0x278)+f(0x19d),CALLBACK_PREFIX+(f(0x1f7)+':')+e+'::'+TIMEFRAMES[f(0x224)+'Y'])[f(0x2ae)]()[f(0x17f)](f(0x202)+f(0x1b9),CALLBACK_PREFIX+(f(0x1f7)+':')+e+'::'+TIMEFRAMES[f(0x16e)+'LY'])[f(0x17f)](f(0x255)+f(0x2c1),CALLBACK_PREFIX+(f(0x1f7)+':')+e+'::'+TIMEFRAMES[f(0x1f6)+'Y'])[f(0x2ae)]()[f(0x17f)](f(0x234)+f(0x250)+f(0x28f)+'a',CALLBACK_PREFIX+(f(0x18d)+f(0x227)+f(0x1ae))+e);return{'text':h,'keyboard':i};}async function generateUserListMenu(l,m,n=0x1){const o=a0B,p=getChatActivity(l)[m];let q=await applyFont(name,o(0x18e)+o(0x2b0)+o(0x207)+'('+(m[o(0x1b1)+'t'](0x0)[o(0x1c1)+o(0x1a4)+'e']()+m[o(0x294)](0x1))+')');if(!p[o(0x21c)]){const w=new InlineKeyboard()[o(0x17f)](o(0x167)+'k',CALLBACK_PREFIX+(o(0x1d4)+':')+l);return{'text':q+(o(0x171)+o(0x28c)+o(0x193)+o(0x26b)+o(0x29d)+o(0x1a7)+o(0x1e0)+o(0x1d8)+o(0x2b7)+'>'),'keyboard':w};}const r=Array[o(0x1c0)](p[o(0x1e9)+'es']())[o(0x2b2)](([,x],[,y])=>y['c']-x['c']),s=Math[o(0x1c2)](r[o(0x185)+'h']/USERS_PER_PAGE);n=Math[o(0x173)](0x1,Math[o(0x28e)](n,s));const t=r[o(0x294)]((n-0x1)*USERS_PER_PAGE,n*USERS_PER_PAGE),u=new InlineKeyboard();t[o(0x243)+'ch'](([x,y])=>{const z=o,A=y['u']?'@'+y['u']:escapeHtml(y['f']);u[z(0x17f)](A+'\x20('+y['c']+')',CALLBACK_PREFIX+(z(0x2c5)+':')+l+'::'+m+'::'+x+'::'+n)[z(0x2ae)]();});const v=[];if(n>0x1)v[o(0x29a)]({'text':o(0x164)+'v','callback_data':CALLBACK_PREFIX+(o(0x1f7)+':')+l+'::'+m+'::'+(n-0x1)});if(n<s)v[o(0x29a)]({'text':o(0x1aa)+'➡️','callback_data':CALLBACK_PREFIX+(o(0x1f7)+':')+l+'::'+m+'::'+(n+0x1)});if(v[o(0x185)+'h'])u[o(0x2ae)](...v);return u[o(0x17f)](o(0x167)+o(0x241)+o(0x178)+o(0x16d),CALLBACK_PREFIX+(o(0x1d4)+':')+l),q+=o(0x1c8)+'e\x20'+n+'/'+s,{'text':q,'keyboard':u};}async function generateUserMessagesView(s,t,u,v=0x1,w=0x1){const x=a0B,y=getChatActivity(s)[t][x(0x2ba)](u),z=y?.['u']?'@'+y['u']:escapeHtml(y?.['f']||x(0x2af));if(!y||!y['m'][x(0x21c)]){const J=await applyFont(name,x(0x298)+x(0x205)+x(0x1ac)+x(0x29e)+x(0x174)+x(0x212)+x(0x24f)+x(0x23c)+x(0x1d0)+x(0x1ec)+u+'\x22>'+z+(x(0x1e2)+x(0x2b4)+x(0x253)+x(0x273))),K=new InlineKeyboard()[x(0x17f)](x(0x167)+x(0x241)+x(0x184)+x(0x1be),CALLBACK_PREFIX+(x(0x1f7)+':')+s+'::'+t+'::'+w);return{'text':J,'keyboard':K};}const A=Array[x(0x1c0)](y['m']),B=[];let C='';const D=x(0x1c7)+x(0x257)+x(0x1d9)+x(0x177)+x(0x2c8)+x(0x272)+x(0x1d7)+x(0x24a)+u+'\x22>'+z+x(0x2bc)+(x(0x238)+(t[x(0x1b1)+'t'](0x0)[x(0x1c1)+x(0x1a4)+'e']()+t[x(0x294)](0x1))+(x(0x264)+'\x0a\x0a'));A[x(0x243)+'ch']((L,M)=>{const N=x,O=M+0x1+(N(0x1a6)+N(0x182))+escapeHtml(L)+(N(0x21b)+N(0x231));C[N(0x185)+'h']+O[N(0x185)+'h']+D[N(0x185)+'h']>0xed8&&C&&(B[N(0x29a)](C),C=''),C+=O;});if(C)B[x(0x29a)](C);const E=B[x(0x185)+'h'];v=Math[x(0x173)](0x1,Math[x(0x28e)](v,E));const F=await applyFont(name,D[x(0x1e5)+'ce'](')',x(0x204)+x(0x1a9)+v+'/'+E+')')),G=F+B[v-0x1],H=new InlineKeyboard(),I=[];if(v>0x1)I[x(0x29a)]({'text':x(0x164)+x(0x1ef),'callback_data':CALLBACK_PREFIX+(x(0x2c5)+':')+s+'::'+t+'::'+u+'::'+(v-0x1)+'::'+w});if(v<E)I[x(0x29a)]({'text':x(0x1aa)+'➡️','callback_data':CALLBACK_PREFIX+(x(0x2c5)+':')+s+'::'+t+'::'+u+'::'+(v+0x1)+'::'+w});if(I[x(0x185)+'h'])H[x(0x2ae)](...I);return H[x(0x17f)](x(0x167)+x(0x241)+x(0x184)+x(0x1be),CALLBACK_PREFIX+(x(0x1f7)+':')+s+'::'+t+'::'+w),{'text':G,'keyboard':H};}function a0b(d,e){const f=a0a();return a0b=function(k,l){const a1=a0d;k=k-0x161;let m=f[k];if(a0b[a1(0x167)+'O']===undefined){var n=function(v){const a2=a1,w=a2(0x174)+a2(0x24f)+a2(0xe9)+a2(0x141)+a2(0x203)+a2(0x257)+a2(0x16e)+a2(0x224)+a2(0xff)+a2(0x136)+a2(0x24a)+a2(0x139)+a2(0x1c6);let x='',y='';for(let z=0x0,A,B,C=0x0;B=v[a2(0x142)+'t'](C++);~B&&(A=z%0x4?A*0x40+B:B,z++%0x4)?x+=String[a2(0x155)+a2(0x148)+'de'](0xff&A>>(-0x2*z&0x6)):0x0){B=w[a2(0x15c)+'Of'](B);}for(let D=0x0,E=x[a2(0x16c)+'h'];D<E;D++){y+='%'+('00'+x[a2(0x1da)+a2(0x10a)](D)[a2(0x183)+a2(0x179)](0x10))[a2(0x18b)](-0x2);}return decodeURIComponent(y);};a0b[a1(0x219)+'w']=n,d=arguments,a0b[a1(0x167)+'O']=!![];}const o=f[0x0],p=k+o,q=d[p];return!q?(m=a0b[a1(0x219)+'w'](m),d[p]=m):m=q,m;},a0b(d,e);}export async function onMessage(j){const k=a0B;if(!botApi)botApi=j[k(0x1ff)];const l=[k(0x1df),k(0x270)+k(0x1df)][k(0x20d)+k(0x17b)](j[k(0x2a3)][k(0x287)]),m=j[k(0x205)+'ge']?.[k(0x17f)]?.[k(0x269)]()?.[k(0x16f)+k(0x1a4)+'e']();if(l){trackMessage(j);if(m===k(0x2b5)+'ve'){const n=await getPublicLeaderboard(j[k(0x2a3)]['id'],TIMEFRAMES[k(0x224)+'Y']);return j[k(0x2a8)](n,{'parse_mode':k(0x1a2),'disable_web_page_preview':!![]});}if(m===k(0x1e3)+k(0x2b1)+'e'){const o=await getPublicLeaderboard(j[k(0x2a3)]['id'],TIMEFRAMES[k(0x1a5)+k(0x224)+'Y']);return j[k(0x2a8)](o,{'parse_mode':k(0x1a2),'disable_web_page_preview':!![]});}}if(j[k(0x2a3)][k(0x287)]===k(0x256)+'te'&&isAdmin(j)&&m===k(0x2b5)+'ve'){const p=await getDefault();if(!p)return j[k(0x2a8)](await applyFont(name,k(0x265)+k(0x162)+k(0x191)+k(0x1dd)+k(0x2a4)));const q=await getConnection(p);if(!q)return j[k(0x2a8)](await applyFont(name,k(0x20c)+k(0x236)+p+(k(0x27e)+k(0x1ca)+'d.')));const {text:r,keyboard:s}=await generateTimeframeMenu(q);await j[k(0x2a8)](r,{'parse_mode':k(0x1a2),'reply_markup':s});}}export async function onCallbackQuery(d){const e=a0B,A=d[e(0x19b)+e(0x1b3)+e(0x2bb)]?.[e(0x2a2)];if(!A?.[e(0x1af)+e(0x1fc)](CALLBACK_PREFIX)||!isAdmin(d))return d[e(0x18c)+e(0x29b)+e(0x195)+e(0x2a1)]({'text':e(0x27d)+e(0x19f)+e(0x186)+'d','show_alert':!![]});await d[e(0x18c)+e(0x29b)+e(0x195)+e(0x2a1)]();if(!botApi)botApi=d[e(0x1ff)];const B=A[e(0x2c2)]('::'),C=B[0x1];try{switch(C){case e(0x268):{const D=Number(B[0x2]),{text:E,keyboard:F}=await generateTimeframeMenu(D);await d[e(0x281)+e(0x1da)+e(0x2c3)](E,{'parse_mode':e(0x1a2),'reply_markup':F});break;}case e(0x19e):{const G=Number(B[0x2]),H=B[0x3],I=Number(B[0x4])||0x1,{text:J,keyboard:K}=await generateUserListMenu(G,H,I);await d[e(0x281)+e(0x1da)+e(0x2c3)](J,{'parse_mode':e(0x1a2),'reply_markup':K});break;}case e(0x1f8):{const L=Number(B[0x2]),M=B[0x3],N=Number(B[0x4]);let O=0x1,P=0x1;if(B[e(0x185)+'h']===0x6)P=Number(B[0x5]);else B[e(0x185)+'h']>=0x7&&(O=Number(B[0x5]),P=Number(B[0x6]));const {text:Q,keyboard:R}=await generateUserMessagesView(L,M,N,O,P);await d[e(0x281)+e(0x1da)+e(0x2c3)](Q,{'parse_mode':e(0x1a2),'reply_markup':R,'disable_web_page_preview':!![]});break;}case e(0x18d)+e(0x227)+'pt':{const T=Number(B[0x2]),U=new InlineKeyboard()[e(0x17f)](e(0x2c7)+e(0x1ad)+e(0x1fa),CALLBACK_PREFIX+(e(0x18d)+e(0x2a7)+e(0x16c))+T)[e(0x17f)](e(0x1bd)+e(0x216),CALLBACK_PREFIX+(e(0x1d4)+':')+T);await d[e(0x281)+e(0x1da)+e(0x2c3)](await applyFont(name,e(0x1ab)+e(0x290)+e(0x169)+e(0x22e)+e(0x25a)+e(0x28b)+e(0x27b)+e(0x25f)+e(0x23b)+e(0x1cf)),{'parse_mode':e(0x1a2),'reply_markup':U});break;}case e(0x18d)+e(0x2a7)+e(0x260):{const V=Number(B[0x2]);activity[e(0x1bf)+'e'](V),await db[e(0x1de)](e(0x1f5)+e(0x1f2)+e(0x219)+e(0x214)+e(0x1bb)+e(0x209)+e(0x2ac)+e(0x194)+e(0x190),V),markChanged();const W=new InlineKeyboard()[e(0x17f)](e(0x1b2)+e(0x241)+e(0x2b8),CALLBACK_PREFIX+(e(0x1d4)+':')+V);await d[e(0x281)+e(0x1da)+e(0x2c3)](await applyFont(name,e(0x226)+e(0x2a9)+e(0x2a4)),{'reply_markup':W});break;}}}catch(X){!X[e(0x218)+e(0x1ed)+'n']?.[e(0x20d)+e(0x17b)](e(0x205)+e(0x286)+e(0x24b)+e(0x28d)+e(0x285))&&(error(e(0x249)+e(0x16b)+e(0x196)+'['+C+e(0x25d)+X[e(0x205)+'ge']),await d[e(0x2a8)](await applyFont(name,e(0x21d)+e(0x17c)+e(0x2b3)+e(0x263))));}}function initializeRollover(){const d=a0B,e=DateTime[d(0x18f)]()[d(0x1fd)+'ne'](TIME_ZONE),f=e[d(0x259)](d(0x1f0))[d(0x170)]({'milliseconds':0x1}),g=f[d(0x22f)](e)['as'](d(0x166)+d(0x1f4)+'ds');setTimeout(()=>{const h=d,i=DateTime[h(0x18f)]()[h(0x1fd)+'ne'](TIME_ZONE);for(const j of activity[h(0x20f)+'s']()){j[TIMEFRAMES[h(0x1d3)]][h(0x288)](),i[h(0x203)+'ay']===0x1&&(j[TIMEFRAMES[h(0x1a5)+h(0x224)+'Y']]=new Map(j[TIMEFRAMES[h(0x224)+'Y']]),j[TIMEFRAMES[h(0x224)+'Y']][h(0x288)]()),i[h(0x1f0)]===0x1&&j[TIMEFRAMES[h(0x16e)+'LY']][h(0x288)](),i[h(0x1f0)]===0x1&&i[h(0x26a)]===0x1&&j[TIMEFRAMES[h(0x1f6)+'Y']][h(0x288)]();}markChanged(),initializeRollover();},g);}async function onShutdown(){const a=a0B;clearTimeout(saveTimer),await saveAllActivityToDB(),process[a(0x22a)](0x0);}export async function initialize(b){const c=a0B;botApi=b[c(0x1ff)],await initDatabase(),await loadActivityFromDB(),initializeRollover(),process['on'](c(0x1ce)+'T',onShutdown),process['on'](c(0x1a3)+'RM',onShutdown),info(c(0x1ba)+c(0x2a6)+c(0x1b4)+c(0x235)+c(0x295)+c(0x1c3)+c(0x213));}