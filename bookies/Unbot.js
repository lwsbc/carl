const a0i=a0b;(function(a,b){const h=a0b,c=a();while(!![]){try{const d=parseInt(h(0x192))/0x1*(parseInt(h(0x183))/0x2)+-parseInt(h(0x190))/0x3*(-parseInt(h(0x1a9))/0x4)+parseInt(h(0x19c))/0x5*(-parseInt(h(0x177))/0x6)+parseInt(h(0x198))/0x7*(-parseInt(h(0x1a3))/0x8)+parseInt(h(0x17e))/0x9*(parseInt(h(0x1b4))/0xa)+parseInt(h(0x186))/0xb+-parseInt(h(0x1b3))/0xc;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0x3073c));function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0x174;let f=c[d];if(a0b['aiKCgb']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0b['OeyiYF']=g,a=arguments,a0b['aiKCgb']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a0b['OeyiYF'](f),a[i]=f):f=j,f;},a0b(a,b);}import a0c from'fs';import a0d from'path';function a0a(){const p=['zwrPyxq','y2HHDeK','C1n5BMm','8j+KLIbnDxq','CMvHzey','zxHPC3q','4PYfie11Da','D3jPDgu','icHYzxq','C3rYAw4','nJuYnZq2shLLAeLf','igvYCM8','zgvZ','zw1Izxi','yM90ia','igzVCIa','yxbP','mtH3yurirNO','zsbMywK','AwXLu3K','Axnbzg0','AxnbCNi','mJrbDvnrEgi','CIa1ige','B3qUANm','mJaYmduWmM1IDeHhwa','igfMDgu','BwvZC2e','y2HHDa','CgfYC2u','Awn0q2G','zxnZAw4','B3qGAge','BgvUz3q','Aw5Nihu','mJDcCfnYsvC','CcbVBIa','mJmYotDus1PSu0q','ihbYB2m','B3jJzwq','DhrLBxa','zwq6ia','Aw4Gy2G','mteYDwnPtNjj','yMvY','igXVywq','BMv3x2m','nun2zgvpva','AxnFyM8','mI4XlJa','zsbTDxq','4P2mieLTBq','Agf0x20','ywLSzwq','mtaYodq4AgjWuwrg','CMvZDhi','CJOG','zsbLBMy','zwnRigy','igLUia','odGWodHpB0v6B3q','ihnHDMu','CMvZB2W','z2LMEq','yxrnzw0','uxvLDwu','B3i6ia','BMrSzxi','CMv0CMK','8j+BKsbhAxy','mJuXntmWoePJz21jCa','mZa1ntyWB3zREeHJ','zgf0ys8','rMLSzvm','igzHAwW','zNjVBq','4O+ZifjLDa','zMLUza','ChvZAa','zwqGzM8','zYbLCNi','DxnLCKK','CNKG','Aw5JBhu','zwqGyM8','Ew5J','DxrMltG','BgvKoIa','qw50Awi','yw50Awi'];a0a=function(){return p;};return a0a();}import{error,info}from'../bookieutils/logger.js';import{getConfig}from'../bookieutils/config.js';import{registerModule}from'../bookieutils/helpeutils/fonthelp.js';export const name=a0i(0x1c5)+'ot';export const version=a0i(0x19e);registerModule(name);const DATA_FILE=a0d[a0i(0x1ab)+'ve'](a0i(0x1b5)+a0i(0x1c6)+a0i(0x185)+'on');let processing=![],globalBot=null,retryTimeout=null;function loadQueue(){const j=a0i;if(!a0c[j(0x1cc)+j(0x1c9)](DATA_FILE))return[];try{return JSON[j(0x18a)](a0c[j(0x1cb)+j(0x180)+'nc'](DATA_FILE,j(0x1c3)))||[];}catch(a){return error(j(0x1ae)+j(0x19a)+j(0x1b7)+j(0x196)+a[j(0x188)+'ge']),[];}}function saveQueue(a){const k=a0i;try{a0c[k(0x174)+k(0x1b6)+k(0x1c2)](DATA_FILE,JSON[k(0x176)+k(0x1ac)](a,null,0x2));}catch(b){error(k(0x1ae)+k(0x1aa)+k(0x1b7)+k(0x196)+b[k(0x188)+'ge']);}}function enqueueRetry(a,b){const l=a0i,c=loadQueue(),d=c[l(0x1ba)](e=>e[l(0x1c8)+'d']===a&&e[l(0x1be)+'d']===b);d?d[l(0x1b1)+'es']=(d[l(0x1b1)+'es']||0x1)+0x1:c[l(0x1bb)]({'chatId':a,'userId':b,'retries':0x1}),saveQueue(c),processQueue();}async function processQueue(){const m=a0i;if(processing)return;processing=!![];try{let a=loadQueue();const b=[];for(const c of a){const {chatId:d,userId:e,retries:retries=0x1}=c;if(retries>0x5){info(m(0x1b2)+m(0x18f)+m(0x191)+m(0x17b)+e+m(0x1a8)+d+(m(0x187)+m(0x184)+m(0x195)+'ts'));continue;}try{await globalBot[m(0x17d)][m(0x1a4)+m(0x18b)+m(0x1ad)+m(0x199)](d,e,{'permissions':{'can_send_messages':![],'can_send_media_messages':![],'can_send_polls':![],'can_send_other_messages':![],'can_add_web_page_previews':![],'can_change_info':![],'can_invite_users':![],'can_pin_messages':![]},'until_date':0x0}),info(m(0x1cd)+m(0x1c1)+'t\x20'+e+m(0x1a8)+d+(m(0x175)+m(0x1bf))+retries+')');}catch(f){error(m(0x1b9)+m(0x1bf)+retries+(m(0x1b7)+m(0x1bc)+'r\x20')+e+':\x20'+f[m(0x188)+'ge']),b[m(0x1bb)]({'chatId':d,'userId':e,'retries':retries+0x1});}await new Promise(g=>setTimeout(g,0xc8));}saveQueue(b),b[m(0x18e)+'h']>0x0&&(retryTimeout=setTimeout(processQueue,0xbb8));}catch(g){error(m(0x1ae)+m(0x193)+m(0x18c)+m(0x1bd)+m(0x1af)+g[m(0x188)+'ge']);}finally{processing=![];}}function isAdmin(a){const n=a0i;try{const {ADMINS:ADMINS=[]}=getConfig();return a&&Array[n(0x182)+'ay'](ADMINS)&&ADMINS[n(0x1c0)+n(0x179)](a['id']);}catch(b){return error(n(0x181)+n(0x197)+n(0x1a7)+n(0x1a2)+':\x20'+b[n(0x188)+'ge']),![];}}export async function initialize(a){globalBot=a,processQueue();}export async function onMessage(a){const o=a0i;try{const b=a[o(0x188)+'ge']?.[o(0x19b)+o(0x1a1)+o(0x17a)+'s'];if(!Array[o(0x182)+'ay'](b)||b[o(0x18e)+'h']===0x0)return;const c=a[o(0x188)+'ge'][o(0x1b8)];if(isAdmin(c))return;for(const d of b){if(!d[o(0x19d)+'t'])continue;try{await a[o(0x17d)][o(0x1a4)+o(0x18b)+o(0x1ad)+o(0x199)](a[o(0x189)]['id'],d['id'],{'permissions':{'can_send_messages':![],'can_send_media_messages':![],'can_send_polls':![],'can_send_other_messages':![],'can_add_web_page_previews':![],'can_change_info':![],'can_invite_users':![],'can_pin_messages':![]},'until_date':0x0}),info(o(0x1ca)+o(0x1a6)+o(0x194)+o(0x17c)+o(0x17b)+d['id']+o(0x1a8)+a[o(0x189)]['id']);}catch(e){error(o(0x1a0)+o(0x1c7)+o(0x19f)+o(0x17f)+o(0x1c4)+e[o(0x188)+'ge']),enqueueRetry(a[o(0x189)]['id'],d['id']);}}}catch(f){error(o(0x1c5)+o(0x18d)+o(0x1b0)+o(0x178)+o(0x1a5)+f[o(0x188)+'ge']);}}