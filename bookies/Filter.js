const a0bI=a0b;(function(a,b){const bH=a0b,c=a();while(!![]){try{const d=-parseInt(bH(0x3ee))/0x1+parseInt(bH(0x16c))/0x2+parseInt(bH(0x2d9))/0x3+-parseInt(bH(0x3cf))/0x4*(-parseInt(bH(0x314))/0x5)+parseInt(bH(0x203))/0x6+parseInt(bH(0x33c))/0x7*(parseInt(bH(0x170))/0x8)+-parseInt(bH(0x321))/0x9;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0x98b98));import{InlineKeyboard}from'grammy';import{error,info}from'../bookieutils/logger.js';import{getConfig}from'../bookieutils/config.js';import{db}from'../bookieutils/db.js';function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0x119;let f=c[d];if(a0b['XjZNzq']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0b['rRkygW']=g,a=arguments,a0b['XjZNzq']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a0b['rRkygW'](f),a[i]=f):f=j,f;},a0b(a,b);}import{getDefault,getConnection}from'../bookieutils/connection.js';import{applyFont,registerModule}from'../bookieutils/helpeutils/fonthelp.js';import a0c from'crypto';function a0a(){const cq=['zsbIDxq','l2v4yw0','zguGyNu','yxbP','C2vYp2K','rdOG','yxvSDca','BNnLx2K','ywnRigu','zZOVl3u','zYbPBMq','DgvYig4','CIbbzg0','BNqGBwK','x3bYB20','igLUieK','igLUigW','B24Uifa','yxn0zxi','DgvYx2m','ifrsqu4','8j+xKE+4JYbezwW','C2vSzwm','AwqGBge','Aw5JBhu','pgK+qNu','BtO6','zwXMyNu','zgvKigy','sw52ywW','DgL0Bgu','zsbMAwW','B24XkgG','CIbSyxK','4P2mie5VDa','C3rYAw4','jMX0oW','wsblrvK','x21HCMS','nfbAtKjJCq','icaGica','CIbhCM8','icaGq1i','yNv0Dg8','vcbJAge','quXvrvm','BgLUzq','mqOHifi','cKzVCIa','tdOG','CYbHzgq','BwvHBJO','y2HHBMC','rgf0ywi','igXHEw8','ANnVBIK','CIbMB3i','DgLVBI4','qujmrsa','C2uGmGO','pgjSB2m','zxmGzxi','C3rYAwS','iej1Dhq','Dcb0Agu','uK9mtei','yxnLiha','zxHLCYa','B3DUigu','Axb0Aw8','mJG1nte1ruLszerI','sfrnta','zxrLiey','Dg9Uiei','oJjDcJ8','Dg9Ux3a','uK9nihu','y2HHCKe','qvrfifq','zNjVBq','rufursa','zsbguK8','D24Gywm','DgvYCY4','DxnLCG','Ahv0zg8','zgv4zxm','zMX0B3a','cLjLCgW','DwvYEq','z2v0q2G','pc9HpG','u2vUzca','BJO6','Ahr0Chm','zhKGzxG','ugfNzsa','ignOB28','tsbZCwW','ywn0Axy','Agf0x2K','yw1L','ignOzwm','uKuGy2G','ig9Uzsa','ig1HEsa','vcbovuW','ihrVige','zw50Axq','DgLVBIa','4Os577Ipie5Via','C3nPBMC','BIbMB3u','4P2tie5Via','B20PcJ8','vxnHz2u','pc9ZpG','C3rHy2S','BMfTzq','CgXLig0','CNmGzgu','Dcb0CNu','DxnLCL8','BMqUifa','zw50','maOGica','ChrPB24','A2v5ifq','ieLgie4','BMq6cG','icHTzxm','ywnRuxu','l2rLBgy','CgXL','zv9RzxK','Cg9UC2u','DgvYoGO','BhqGzM8','CL9JEwm','pgnVzgu','BMCGzgu','Axn0lG','Aw52ywW','qNv0Dg8','4PYfifjLCW','DgvYihi','AYbLCNi','yxmGDw4','BNnLigq','ihnLBgu','yxrFAwq','y29UzMK','B25Z','yxnLigK','DgvYx3a','DxjLzc4','Bw9KAwy','CI4GugW','B25Zihy','rM9YieK','x21Vzgu','BgzIDxq','y3vZDg8','CZO6','B3qGzM8','BM90rM8','ihnWzwm','thmSig8','AguGzgu','ifrfwfq','y2TXDw8','B24Gzge','ig1Lyw4','BgfZDeK','y2HHDf8','DhrVBNm','suqGpgi','CMvWBge','CMvHzhK','DgfKzhi','CMv2zxi','yw5ZD2u','BgL6zwq','BwLSyxi','AxrLx20','BMfTzs4','C2vFChi','BgvUz3q','C2vYx3i','zxjdyxm','lY9LEge','DgLVBNm','ign1CNi','Dw5KlGO','zxjFCMu','ihrLEhq','DgGGl2q','qM90igK','BhrLCIa','lIbvC2K','BgvHC2u','CM1HDdO','Dg9Ux3m','ufjbr00','CNjVCJO','Acb0Agu','zw5K','icaGy2G','DgvYihy','AcbMB3u','yw55igy','BML0Awe','yMXVy2S','yMfJAYa','BM93','ywW6igi','zguGzMK','ieLeoIa','BMqU','BIbyoLK','CxvPCMu','ihbLBMq','DgvYigm','B25Ziha','lI4UkqO','zwqUifq','BIbKzwy','z2LMEq','yM9Sza','yw1LcLS','C2L6zq','z2v0','BIbUyw0','4P2mievYCG','Dg9UmIG','B3vWigm','Bgv0zwq','yxqGsuq','zwqG','zcbMCM8','q0uGsu4','pYbcDxq','CxvVDgu','C3vNz2u','zxrPB24','8j+sOsbeAwq','zt4k8j+tGsa','C3nLzc4','t1qGrvG','u0fdveK','Esb3Axq','rsbguK8','BhrLCJe','z2fPBI4','DgvYici','zxH0xs4','zxKSigm','lIWGmtO','zv9Hzgq','CKnHBgW','yw1LCY4','4P2mie5Via','vuXmcIa','BIbJB3u','rM9YBwe','zxiGCM8','BgLKoIa','x3nLBgu','yxzLigm','Bwukisa','B3iGzMK','y2vPBa','DxbZ','zxm6pc8','icG/lca','zwqPlG','AxnbCNi','C2vZige','qsb0ywi','twf4idG','zwrPDe0','BweGC2u','iokaOIaUlG','uhjVDMK','Aw9Uihq','BgLUAW','rsb0Exa','C3rHDhu','oI8VzxG','BMrFzgu','Ac4GrgK','DguU','Aw5Nigi','phrNlwu','EhqU','Dgu+','ChjVDMK','DgvYCW','rfjpuca','B21WBgu','DhrWCZO','BIbWCM8','x2n5y2W','BgvFA2u','pc90zY0','qu5eig4','C3rHCNq','vcbUyw0','pgeGAhi','lIbqBgu','B25Zzv8','zsbMB3i','ywrK','DgeGzM8','DxjS','suqGBwK','qunl','CIb0BYa','Agv5ig0','revgqvu','zxn0yxi','Aw4GzMK','D24UlI4','BMuGDg8','iokaOIa','C2vWyxi','igfUzc8','B21Tysa','Dg9U','DxqU','rvHuifa','zv9Yzxm','BhrLCK4','zv9IDxq','BMCGywm','z19QC28','CIbJB20','4P2miezHAq','A2v5lca','twvUDq','vcbMAwW','DgHPCYa','zxrLifi','pc9IpIi','ihjLC3a','CgfYC2u','ugXLyxm','DxjYzw4','pc9IpG','CM9Tigy','yMXLjYa','y3rPB24','C3bVAwW','mJiYotuXnKrYDxPWrW','BNrFAw4','u2H1Dgq','CgXLlMm','nty3ntmZnKH4zxHOrG','pc9PpG','B3iGy3i','AwqGyNu','DgfYDca','zcbPBIa','lI4U','DcbgAwW','BwfPBG','uKLnqvi','DgvZDa','ihjLC3u','zgu+','4P2mifbSzq','BMvSigy','zxiGzMK','y29TBwe','CYbMB3u','CYKGDg8','pc9IpGO','CL9JB24','C1DPDgG','B3v0ihC','Bgv0Aw8','4P2mieLUDG','BwfW','4P2mienHBG','zgvMCW','DhjPBq','BhjLC3a','iensrue','C2u6oG','yxzLige','oJWVAt4','y29Kzq','DcbVCIa','At4k','DcWGzs4','Df9PzcW','DcbSzwe','B25Jzq','BwvZC2e','zgqGCMu','mI4YlJa','4O+X77IpiefJDa','BNnLsw4','zM9Yia','mL0kpYa','icK7cIa','y2XLx2S','8j+AQYboB3q','ifDirvi','igzVDw4','zw50x2K','igj1Dhq','ywrKx2i','pc9JB2q','BMrLEca','Dgu6','pgi+rMK','CIbKzwW','tfqGmaO','8j+uLYa8y28','AwqGzge','ifjLC3a','jNf1B3q','phu+','suqG','kgzPBhq','ifbssu0','C29Tzq','u2f2Aw4','BwLU','zxHLyW','AM9PBG','iokaOIa8Aq','phbYzt4','4PYfiefKza','zxjYB3i','Agf2zsa','Dxr0B24','qKvhsu4','q2fSBgi','ig1VCMu','yw1LcIe','BNn0yw4','B3i6ie4','idik','l2nHBMm','y2XVC2u','A2v5CW','zsbMCM8','DgHLigq','zM8ODxm','B25Zigy','DhbZoI8','igLUzgu','ignVBMy','BMrLEgu','B2nLC3m','zwqGzxi','D2L0Aca','tM8GzMK','ANnVBIa','zgvSzxq','BMfSoIa','y29Kzt4','y2fSBgi','AwDZlG','BYbKzwW','yw1WBgu','CgfYyxq','y2vS','pc9PpGO','DwDO','yxrLzcK','AwvK','zgvMyxu','zxbSywm','pc9WCMu','zxj5','y2vSBgu','igf1DgG','yJ4k','cIeGuMu','BMv3igi','BM90x2y','zxmGkgm','CMvZCg8','rxjYB3i','BwfZDgu','su5uruC','B25Zzxm','zxGPify','EwnSzv8','lIbgAwW','zcWGy28','tM8GC2K','CgvUzgK','B25ZzsG','tg9Hzca','u2f2zsa','BNvTyMu','C2uGDgu','ig5VDca','qvvmvca','Aw9Uigu','nJy1nJK0mgvMzLzNtG','zxiY','DgrLBhi','BxbSzs4','C2XPy2u','rviGtK8','vxnLCIa','C2uGD2G','Aw5Nihi','u0vmrum','4PYfien1CG','ieLoveu','CM92Awq','zenVBNq','BgLHC08','yxrJAgu','DhLWzq','CMvKDwm','zw1VAMK','y3vYCMu','vcbpuIa','l2zPBhq','DgvKigy','igrLBgu','Ew91Dca','BM9VCa','iJXIpG','B21WDa','zsbHy3q','laOGica','igzVCIa','zsbYzxm','BIbJyw4','zgf0zwq','cGPgAwW','tcberuy','ve8GzMK','tsbMAwW','zw50CMK','BJeOAhq','CgL0zsa','BgvHC3q','BgvKihq','zxrLigi','Bw9Kzq','revmrvq','zxrLiei','Dw5Kzxi','BgvFAw4','Df9PBMq','Cgf0Ag4','BwfUzca','ihrOzsa','B3jLihm','CMvHDgu','yxKGywW','reiGAw4','C3m6oG','DgfKzgi','EhbLy3q','DcbMB3i','ywXPzca','C2v0','w25HBwu','BgLZDgi','ywXYzwe','DxaGjW','rMLSDgu','BIbUB3q','CYb0ywi','zxiGB2y','zYbMAwW','B24GrLi','tMv4Dca','uMvHzhK','icaGigm','ugfYC2u','ywnRx3e','AwfSAxO','Dgv4Df8','zMf1Bhq','Dgv4Dca','DgvYtMe','pc9IpJO','C2uG','ihrVigq','Bwf0y2G','veuGvee','AwqGy2G','ywn0ihi','BhqGz3i','CYbxseu','AwqGC2u','wY4UlL0','zgv4','ifzbtfu','t00GzMK','ig1HDgm','igLUAxq','tK9uie4','Ag9ZDg4','x19PC0e','D24Gq2G','y2uGCMu','zdOG','rvKScIa','C21HDgm','CIbMAwW','BYb2ywW','CNm6cG','zwfZzsa','zgv4iey','jMD0oW','twLNCMe','zxi+','ihrYEsa','B3vUza','Bwf4','zgvZy3i','pgK+','C2uGC2u','zxiG','BMrLEe8','phm+','4PYfifjLCa','icbduKu','su5trvi','Dg9mB3C','zxHLCYK','zgvZ','C3bVBNm','zgqGyNu','DgeU','BNnLCW','zxGGsu4','AwzPzwq','kaOGica','AgfZ','zxm7','DgvYoIa','vevyvca','CM93ig0','C3bSAxq','uKvqtee','cIaGica','icHJB20','icHSAxm','AxrHBgK','idek','yMfJA1e','4PYfierLBa','ihjLC3q','ihLVDsa','8j+tIYbmAxm','zxnWB24','zt4IicG','A3f1B3q','C3mGD2K','Bvvvsuq','y2HHDa','Bgj0BNa','B3vWlG','Eu1HCMS','ve8GDxm','CYC7','igLUDMe','vefcteu','4P2mifvUzq','DhrVBIa','zwqGDg8','jYbUB3q','zwXLDgK','CMLUzW','CK5HBwu','zMX0oJO','AMLFAwq','B3vUzc4','Dhj1BMm','Bwukw08','ifrOzxK','y2vSlG','jMfTCdS','4P2mierPCW','lcaR','C3vSDca','l2XPC3q','yxnLihi','B3i6ia','icaPoWO','4P6viefKza','4PYfiezPBa','zwXLy3q','icGkica','zcb5B3u','y2XLyxi','CNmGzxi','Dg9Uig4','qvjzieS','twvUDsa','yxLVDxq','jImWmZK','Bw9QAsa','CYKU','BMzPz18','ywrKx3i','z3jVDxa','zv9MAwW','BsbMAwW','zxiGiG','ignHBgW','C3bSAwm','zvjLCgW','yw1LpsC','Dhj5ige','mZa2mZm2mevbtNjuzG','Aw4Guge','icaGy28','pgi+uMu','zgLZBwK','4P2mierLzG','BMnHDgu','u0Lhveu','C2vFAw4','zxiXlgy','4PYfiej1Da','B25MAwC','C29YDa','BNnLihq','DxqGzM8','B25Zzsa','ywn0Aw8','DcbcDxq','B3jPEMu','DdOG','igvYCM8','zv9PBMq','B3iGDxa','lwLKpsi','oJWVyJ4','BMfTzxm','zxmU','C2uGw3q','uMvZCg8','ChjPDMe','Cg9PBgu','CM9TChq','vw5RBM8','AwvZ','lcbKzxm','AdOG','ig11Bhq','qwrTAw4','Aw4GzM8','phrNlxm','ieLeia','zM9YieK','B24OCYK','zxHLCY4','AwDFANm','svnuuYa','vevhrvi','C3qGB24','Dw5K','CMfUzg8','Dg9Uigq','y29TkqO','zM9YigW','B24YkgG','yMvPBMC','zxrLlG','zwy9iNq','u2f2zwq','zsaYcGO','nti4mdG2nw5pBLvqDa','zvrLEhq','lMnVBsK','Chq6ia','zwqU','Bv9LBw8','zxrLzdO','ig51Bwi','8j+uMca8yJ4','uMvZDwW','BhrLCL8','B24GChi','ignOyxq','mZy4otG5ndDiA0zKBKW','zYbIzwy','tcbPBIa','z3mGkgm','BMqGAw4','ywXS','DMfSAwq','zcbLEha','CdO6','cIaGici','AwqGvvi','ywDHAw4','B2zMC2u','rwfJAca','EgvZlG','z2uGAxm','AxbSzsa','C3vIC3q','zM9YBwe','BMv3ihi','zsbHDca','zY4Side','zxnZywC','Dw5KlIa','id0GpW','oGOkiJW','BK5HBwu','n0TVuvjezW','CIbUyw0','zMLNCYa','BgzPBhq','pc9IBg8','igzPBhq','icbMAwW','rvmGkd8','Dg9UCW','C2fNzsa','ChvZAa','zgf0yq','Bgf5B3u','zwy9iG','BgLZDgy','DdOGrMK','zMLSDgu','zMfPBgu','zxHHy3q','BNnLvgu','8j+tLIbmAxm','y2vZCYa','B3iG','Dxn0igG','BxvSDgK','BIaXoJe','pgi+','AwnOig8','uhj1BMu','CNvU','igXPC3q','AxjLzca','C3rPB24','ChjVy2u','BNnLide','ihvZzxi','BwfPBJO','BgvJDgK','ChjVBxa','icaGigy','ihnLDc4','ifG6wsa','ChjL','lcbLlMC','isbszxm','l2XPC2y','Dgv4Da','lca/kq','CMvWBhK','CYaOcIa','BNnLlG','CMvUDca','qKXfihu','ie5pvca','igv4Axm','BwvUDgK','zM9Yrwe','yxj0ihq','lgzPBhq','oIaVzgu','zwf0Aw4','4P2mieDYBW','DgLUzYa','l2rLBhi','BgfJzwq','B3DUihm','B24GCMu','zguGzxG','t3b0Aw8','tM8GyNu','CM93','AwX0zxi','sw5PDca','pgK+uMu','4P2miej1Da','zxjFy3K','DdOGl2y','pc91pG','Aw5KzxG','Dg9UmsG','zwXLDgu','q09ntuK','u0Lhsu4','AxqGzxi','zMX0ywq','CM9YoIa','zxrOCM8','EhbPCMu','tMfTzq','BYbJyw4','BhrLCNm','WQSGuhjL','8j+uMsbcywm','tLvmtca','DgrLBgy','icvVcIu','x3jLC3a','r0vsifa','rxHHy3q','BwLZCYa','BguUlI4','pc9IpI8','y2HHDeK','zt0NDge','tg9Hzgu','txvSDgK','lMfUzca','zgrLzc4'];a0a=function(){return cq;};return a0a();}export const name=a0bI(0x246)+'r';export const version=a0bI(0x19b);registerModule(name);const CALLBACK_PREFIX=a0bI(0x2b1),ADMIN_CALLBACK_PREFIX=a0bI(0x390)+a0bI(0x3c2),PENDING_ACTION_TTL_MS=0x14*0x3c*0x3e8,FILTER_SAVE_DEBOUNCE_MS=0x1388,USER_INDEX_SAVE_DEBOUNCE_MS=0x7d0,LEVENSHTEIN_DISTANCE_THRESHOLD=0x5,FILTERS_PER_PAGE=0x5,BUTTONS_PER_PAGE=0x5,MAX_MESSAGE_LENGTH=0xfa0,filters=new Map(),userResponseIndex=new Map(),pendingActions=new Map(),pendingAdminActions=new Map();let filterSaveTimer=null,userIndexSaveTimer=null,prunePendingInterval=null,botApi=null;function escapeHtml(a){const bJ=a0bI;return a[bJ(0x459)+'ce'](/&/g,bJ(0x2b8))[bJ(0x459)+'ce'](/</g,bJ(0x3cc))[bJ(0x459)+'ce'](/>/g,bJ(0x273))[bJ(0x459)+'ce'](/"/g,bJ(0x1b1)+';')[bJ(0x459)+'ce'](/'/g,bJ(0x2cb)+';');}function generateUniqueToken(){const bK=a0bI;let a;do{a=a0c[bK(0x30a)+bK(0x2a1)]();}while(pendingActions[bK(0x28c)](a));return a;}function isAdmin(a){const bL=a0bI;try{const {ADMINS:ADMINS=[]}=getConfig();return!!a[bL(0x3f7)]?.['id']&&Array[bL(0x11f)+'ay'](ADMINS)&&ADMINS[bL(0x3c0)+bL(0x284)](a[bL(0x3f7)]['id']);}catch(b){return error(bL(0x2fe)+bL(0x40e)+bL(0x43a)+bL(0x2be)+b[bL(0x199)+'ge']),![];}}function getChatFilters(a){const bM=a0bI;return!filters[bM(0x28c)](a)&&filters[bM(0x241)](a,new Map()),filters[bM(0x48f)](a);}function prunePendingTokens(){const bN=a0bI,a=Date[bN(0x47e)]();for(const [b,c]of pendingActions){c['ts']&&a-c['ts']>PENDING_ACTION_TTL_MS&&pendingActions[bN(0x1d8)+'e'](b);}for(const [d,e]of pendingAdminActions){e['ts']&&a-e['ts']>PENDING_ACTION_TTL_MS&&pendingAdminActions[bN(0x1d8)+'e'](d);}info(bN(0x358)+bN(0x328)+bN(0x35b)+bN(0x1fa)+bN(0x159)+bN(0x467)+'.');}async function initDatabase(){const bO=a0bI;try{await db[bO(0x1b9)](bO(0x293)+bO(0x3d0)+bO(0x3d2)+bO(0x3f8)+bO(0x2a9)+bO(0x428)+bO(0x4a0)+bO(0x306)+bO(0x34c)+bO(0x184)+bO(0x33e)+bO(0x28b)+bO(0x3d0)+bO(0x3d0)+bO(0x477)+bO(0x43e)+bO(0x20e)+bO(0x39d)+bO(0x179)+bO(0x3cd)+bO(0x220)+bO(0x3d0)+bO(0x3d0)+bO(0x2db)+bO(0x2ce)+bO(0x1d7)+bO(0x28f)+bO(0x266)+bO(0x4ae)+bO(0x3d0)+bO(0x3d0)+bO(0x1a0)+bO(0x3d0)+'\x20\x20');const a=await db[bO(0x48f)](bO(0x20c)+bO(0x13e)+bO(0x3f9)+bO(0x40a)+bO(0x460)+bO(0x3ba)+bO(0x1a3)+bO(0x129)+bO(0x3a3)+bO(0x169)+bO(0x13c)+bO(0x2d7)+bO(0x422)+bO(0x1f0)+bO(0x3af)+bO(0x1d2)+bO(0x2a7));if(a){const b=await db[bO(0x326)](bO(0x473)+bO(0x121)+bO(0x233)+bO(0x1cd)+bO(0x46a)+bO(0x285)+bO(0x2ee)+bO(0x283)+';'),c=b[bO(0x1b6)](d=>d[bO(0x41e)]===bO(0x34c)+bO(0x432)+bO(0x13a)+'y');!c&&(info(bO(0x274)+bO(0x37a)+bO(0x422)+bO(0x1f0)+bO(0x3af)+bO(0x1d2)+bO(0x248)+bO(0x3a0)),await db[bO(0x1b9)](bO(0x135)+bO(0x2a9)+bO(0x35f)+bO(0x39c)+bO(0x141)+bO(0x38a)+bO(0x28d)),await db[bO(0x1b9)](bO(0x293)+bO(0x3d0)+bO(0x3d0)+bO(0x3d0)+bO(0x18e)+bO(0x25a)+bO(0x370)+bO(0x464)+bO(0x29d)+bO(0x2e1)+bO(0x3fe)+bO(0x2c3)+bO(0x3d0)+bO(0x3d0)+bO(0x3d0)+bO(0x3d0)+bO(0x342)+bO(0x3bb)+bO(0x1f6)+bO(0x427)+bO(0x155)+bO(0x179)+bO(0x3cd)+bO(0x220)+bO(0x3d0)+bO(0x3d0)+bO(0x3d0)+bO(0x3d0)+bO(0x468)+bO(0x1a5)+bO(0x1a9)+bO(0x1f3)+bO(0x208)+bO(0x412)+bO(0x226)+bO(0x201)+bO(0x425)+bO(0x3d0)+bO(0x3d0)+bO(0x3d0)+bO(0x2bf)+bO(0x3d0)+bO(0x3d0)+bO(0x3d0)+'\x20'));}else await db[bO(0x1b9)](bO(0x293)+bO(0x3d0)+bO(0x3d0)+bO(0x280)+bO(0x3f6)+bO(0x3e2)+bO(0x422)+bO(0x1f0)+bO(0x3af)+bO(0x1d2)+bO(0x36d)+bO(0x3d0)+bO(0x3d0)+bO(0x3d0)+bO(0x363)+bO(0x383)+bO(0x139)+bO(0x42e)+bO(0x451)+bO(0x1b5)+bO(0x2c8)+bO(0x26c)+bO(0x3d0)+bO(0x3d0)+bO(0x3d0)+bO(0x24e)+bO(0x166)+bO(0x234)+bO(0x289)+bO(0x307)+bO(0x371)+bO(0x399)+bO(0x14a)+bO(0x1ad)+bO(0x3d0)+bO(0x3d0)+bO(0x3d0)+bO(0x1a0)+bO(0x3d0)+bO(0x3d0)+'\x20');info(bO(0x3dd)+bO(0x441)+bO(0x47b)+bO(0x45e)+'.');}catch(d){error(bO(0x23b)+bO(0x38f)+bO(0x391)+d[bO(0x199)+'ge']);throw d;}}function rehydrateChatFilters(a){const bP=a0bI,b=new Map();for(const c in a){const d=a[c];if(d){d[bP(0x1f0)+bP(0x288)]?d[bP(0x1f0)+bP(0x288)]=d[bP(0x1f0)+bP(0x288)][bP(0x189)](e=>{const bQ=bP;if(typeof e===bQ(0x3cb)+'g')return{'text':e,'entities':[]};if(!Array[bQ(0x11f)+'ay'](e[bQ(0x414)+bQ(0x2fa)]))e[bQ(0x414)+bQ(0x2fa)]=[];return e;}):d[bP(0x1f0)+bP(0x288)]=[];if(!d[bP(0x3d3)+'ns'])d[bP(0x3d3)+'ns']=[];if(!d[bP(0x348)+'t'])d[bP(0x348)+'t']=[];}else d={'responses':[],'buttons':[],'layout':[]};b[bP(0x241)](c,d);}return b;}async function loadFiltersFromDB(){const bR=a0bI;try{const a=await db[bR(0x326)](bR(0x20c)+bR(0x3d4)+bR(0x196)+bR(0x1d1)+bR(0x305)+bR(0x24b)+bR(0x263)+bR(0x31e)+bR(0x43f)+'gs');filters[bR(0x2c5)]();for(const b of a){try{const c=JSON[bR(0x164)](b[bR(0x43f)+bR(0x15a)+'n']);filters[bR(0x241)](b[bR(0x456)+'id'],rehydrateChatFilters(c));}catch(d){error(bR(0x24f)+bR(0x2ed)+bR(0x3e0)+bR(0x320)+'\x20'+b[bR(0x456)+'id']+':\x20'+d[bR(0x199)+'ge']),await db[bR(0x359)](bR(0x230)+bR(0x4a3)+bR(0x228)+bR(0x3bb)+bR(0x2e4)+bR(0x25e)+bR(0x40f)+bR(0x43e)+bR(0x339),b[bR(0x456)+'id']);}}info(bR(0x3a4)+'d\x20'+filters[bR(0x48e)]+(bR(0x320)+bR(0x1d1)+bR(0x1dc)));}catch(f){error(bR(0x1fc)+bR(0x34c)+bR(0x2c6)+bR(0x391)+f[bR(0x199)+'ge']);}}function dehydrateChatFilters(a){const bS=a0bI,b={};for(const [c,d]of a[bS(0x229)+'es']()){b[c]={...d};}return b;}function markFiltersChanged(){clearTimeout(filterSaveTimer),filterSaveTimer=setTimeout(saveAllFiltersToDB,FILTER_SAVE_DEBOUNCE_MS);}async function saveAllFiltersToDB(){const bT=a0bI;info(bT(0x1b7)+bT(0x24a)+bT(0x3fb)+'..');let a=0x0;await db[bT(0x359)](bT(0x1c1)+bT(0x3bc)+bT(0x4a1)+'ON');try{for(const [b,c]of filters[bT(0x229)+'es']()){const d=JSON[bT(0x3cb)+bT(0x48b)](dehydrateChatFilters(c));await db[bT(0x359)](bT(0x281)+bT(0x217)+bT(0x292)+bT(0x498)+bT(0x227)+bT(0x31e)+bT(0x43f)+bT(0x324)+bT(0x40c)+bT(0x1f8)+bT(0x2ce)+bT(0x3df)+bT(0x262)+bT(0x343)+bT(0x36b),b,d),a++;}await db[bT(0x359)](bT(0x38d)+'T'),info(bT(0x312)+'\x20'+a+(bT(0x320)+'s.'));}catch(f){await db[bT(0x359)](bT(0x3e9)+bT(0x147)),error(bT(0x1fd)+bT(0x1be)+':\x20'+f[bT(0x199)+'ge']);}}async function loadUserResponseIndexesFromDB(){const bU=a0bI;try{const a=await db[bU(0x326)](bU(0x20c)+bU(0x15f)+bU(0x3bb)+bU(0x1f6)+bU(0x15d)+bU(0x216)+bU(0x16d)+bU(0x272)+bU(0x3f4)+bU(0x464)+bU(0x29d)+bU(0x2e1)+bU(0x3fe));userResponseIndex[bU(0x2c5)]();for(const b of a){userResponseIndex[bU(0x241)](b[bU(0x34c)+bU(0x432)+bU(0x13a)+'y'],b[bU(0x216)+bU(0x16d)+bU(0x261)]);}info(bU(0x3a4)+'d\x20'+userResponseIndex[bU(0x48e)]+(bU(0x1d0)+bU(0x32f)));}catch(c){error(bU(0x1fc)+bU(0x38a)+bU(0x3e5)+bU(0x391)+c[bU(0x199)+'ge']);}}function markUserIndexChanged(){clearTimeout(userIndexSaveTimer),userIndexSaveTimer=setTimeout(saveUserResponseIndexesToDB,USER_INDEX_SAVE_DEBOUNCE_MS);}async function saveUserResponseIndexesToDB(){const bV=a0bI;info(bV(0x1b7)+bV(0x3b2)+bV(0x304)+'..');let a=0x0;await db[bV(0x359)](bV(0x1c1)+bV(0x3bc)+bV(0x4a1)+'ON');try{for(const [b,c]of userResponseIndex[bV(0x229)+'es']()){await db[bV(0x359)](bV(0x281)+bV(0x217)+bV(0x292)+bV(0x498)+bV(0x2a6)+bV(0x46a)+bV(0x285)+bV(0x2ee)+bV(0x3eb)+bV(0x1b4)+bV(0x387)+bV(0x1a1)+bV(0x4a8)+bV(0x166)+bV(0x234)+bV(0x1f5)+bV(0x3d5)+bV(0x11d)+'?)',b,c),a++;}await db[bV(0x359)](bV(0x38d)+'T'),info(bV(0x312)+'\x20'+a+(bV(0x1d0)+bV(0x32f)));}catch(d){await db[bV(0x359)](bV(0x3e9)+bV(0x147)),error(bV(0x1fd)+bV(0x1be)+':\x20'+d[bV(0x199)+'ge']);}}function formatTextWithEntities(a,b){const bW=a0bI;if(!b||b[bW(0x463)+'h']===0x0)return escapeHtml(a);const c=[];b[bW(0x374)+'ch'](g=>{const bX=bW,h=g[bX(0x32d)+'t'],i=g[bX(0x32d)+'t']+g[bX(0x463)+'h'];c[bX(0x346)]({'offset':h,'type':g[bX(0x213)],'action':bX(0x13d),'entity':g}),c[bX(0x346)]({'offset':i,'type':g[bX(0x213)],'action':bX(0x476),'entity':g});}),c[bW(0x2e5)]((g,h)=>{const bY=bW;if(g[bY(0x32d)+'t']!==h[bY(0x32d)+'t'])return g[bY(0x32d)+'t']-h[bY(0x32d)+'t'];return g[bY(0x2e9)+'n']===bY(0x476)?-0x1:0x1;});let d='',e=0x0;const f=[];return c[bW(0x374)+'ch'](g=>{const bZ=bW;g[bZ(0x32d)+'t']>e&&(d+=escapeHtml(a[bZ(0x207)](e,g[bZ(0x32d)+'t'])),e=g[bZ(0x32d)+'t']);if(g[bZ(0x2e9)+'n']===bZ(0x13d)){let h='';switch(g[bZ(0x213)]){case bZ(0x48c):h=bZ(0x356);break;case bZ(0x296)+'c':h=bZ(0x27a);break;case bZ(0x232)+bZ(0x3d6):h=bZ(0x1b2);break;case bZ(0x3e6)+bZ(0x392)+bZ(0x1e2):h=bZ(0x27e);break;case bZ(0x192):h=bZ(0x433)+'>';break;case bZ(0x366):h=bZ(0x1bc);break;case bZ(0x47c)+bZ(0x49a):h=bZ(0x3e4)+bZ(0x29f)+'e>';break;case bZ(0x252)+bZ(0x128):h=bZ(0x13f)+bZ(0x349)+escapeHtml(g[bZ(0x414)+'y'][bZ(0x145)])+'\x22>';break;case bZ(0x252)+bZ(0x373)+'on':h=bZ(0x13f)+bZ(0x311)+bZ(0x3b1)+bZ(0x3ac)+'d='+g[bZ(0x414)+'y'][bZ(0x3fc)]['id']+'\x22>';break;case bZ(0x16b)+'er':h=bZ(0x300)+bZ(0x2f7)+'r>';break;case bZ(0x44a)+bZ(0x319)+'ji':h=bZ(0x130)+bZ(0x2cc)+bZ(0x215)+bZ(0x2f0)+g[bZ(0x414)+'y'][bZ(0x44a)+bZ(0x319)+bZ(0x2b2)]+'\x22>';break;default:h='';}d+=h,f[bZ(0x346)](g[bZ(0x213)]);}else{if(g[bZ(0x2e9)+'n']===bZ(0x476)){const i=f[bZ(0x455)+bZ(0x27d)+'f'](g[bZ(0x213)]);if(i!==-0x1){const j=f[bZ(0x2d5)+'e'](i);j[bZ(0x45c)+'se']()[bZ(0x374)+'ch'](k=>{d+=getClosingTag(k);});}}}}),e<a[bW(0x463)+'h']&&(d+=escapeHtml(a[bW(0x207)](e))),f[bW(0x45c)+'se']()[bW(0x374)+'ch'](g=>{d+=getClosingTag(g);}),d;}function getClosingTag(a){const c0=a0bI;switch(a){case c0(0x48c):return c0(0x167);case c0(0x296)+'c':return c0(0x171);case c0(0x232)+c0(0x3d6):return c0(0x389);case c0(0x3e6)+c0(0x392)+c0(0x1e2):return c0(0x41c);case c0(0x192):return c0(0x1a8)+'e>';case c0(0x366):return c0(0x1e7)+'>';case c0(0x47c)+c0(0x49a):return c0(0x340)+c0(0x452)+c0(0x132);case c0(0x252)+c0(0x128):return c0(0x403);case c0(0x252)+c0(0x373)+'on':return c0(0x403);case c0(0x16b)+'er':return c0(0x13b)+c0(0x16b)+c0(0x275);case c0(0x44a)+c0(0x319)+'ji':return c0(0x13b)+c0(0x215)+'>';default:return'';}}function parseFilterCommandAndContent(a,b){const c1=a0bI,c=a[c1(0x291)]('\x0a'),d=c[0x0],e=d[c1(0x282)+c1(0x465)+'e']()[c1(0x13d)+c1(0x185)](c1(0x218)+c1(0x27c))?d[c1(0x207)](0x8)[c1(0x291)](',')[c1(0x189)](o=>o[c1(0x18c)]())[c1(0x34c)+'r'](Boolean):[],f=[],g=[];let h=-0x1,j=-0x1,k=![];const l=a[c1(0x38a)+'Of'](d)+d[c1(0x463)+'h'];let n=l;for(let o=0x1;o<c[c1(0x463)+'h'];o++){const p=c[o],q=p[c1(0x18c)](),r=a[c1(0x38a)+'Of'](p,n),s=r+p[c1(0x463)+'h'];n=s+(o<c[c1(0x463)+'h']-0x1?0x1:0x0);if(q[c1(0x259)](/^button\s/i)||q[c1(0x13d)+c1(0x185)]('?')||q[c1(0x13d)+c1(0x185)](c1(0x3d3)+'n:')){if(h!==-0x1){const t=a[c1(0x332)+c1(0x2af)](h,j);f[c1(0x346)]({'text':t,'entities':b[c1(0x34c)+'r'](u=>u[c1(0x32d)+'t']>=h&&u[c1(0x32d)+'t']+u[c1(0x463)+'h']<=j)[c1(0x189)](u=>({...u,'offset':u[c1(0x32d)+'t']-h}))}),h=-0x1,j=-0x1;}k=!![];}if(!k){if(q[c1(0x13d)+c1(0x185)]('!')){if(h!==-0x1){const w=a[c1(0x332)+c1(0x2af)](h,j);f[c1(0x346)]({'text':w,'entities':b[c1(0x34c)+'r'](x=>x[c1(0x32d)+'t']>=h&&x[c1(0x32d)+'t']+x[c1(0x463)+'h']<=j)[c1(0x189)](x=>({...x,'offset':x[c1(0x32d)+'t']-h}))});}const u=p[c1(0x38a)+'Of']('!'),v=u+0x1;h=r+v,j=s;if(p[c1(0x332)+c1(0x2af)](v)[c1(0x18c)]()===''&&o+0x1<c[c1(0x463)+'h']){let x=o+0x1,y=c[x],z=y[c1(0x18c)](),A=a[c1(0x38a)+'Of'](y,n);while(x<c[c1(0x463)+'h']&&(z===''||z[c1(0x259)](/^button\s/i)||z[c1(0x13d)+c1(0x185)]('?')||z[c1(0x13d)+c1(0x185)](c1(0x3d3)+'n:'))){n=A+y[c1(0x463)+'h']+(x<c[c1(0x463)+'h']-0x1?0x1:0x0),x++;if(x<c[c1(0x463)+'h'])y=c[x],z=y[c1(0x18c)](),A=a[c1(0x38a)+'Of'](y,n);else break;}x<c[c1(0x463)+'h']&&z!==''&&(p[c1(0x332)+c1(0x2af)](v)[c1(0x18c)]()===''&&(h=A),j=A+y[c1(0x463)+'h'],o=x,n=j+(o<c[c1(0x463)+'h']-0x1?0x1:0x0));}}else h!==-0x1&&(j=s);}else{if(q[c1(0x259)](/^button\s/i)||q[c1(0x13d)+c1(0x185)](c1(0x3d3)+'n:')){const B=q[c1(0x259)](/^button:?\s*([0-9:]+)?\s*(.*)$/i);if(!B)throw new Error(c1(0x3c5)+c1(0x173)+c1(0x2ab)+c1(0x333)+c1(0x2ec)+q);const C=B[0x1],D=B[0x2];let E=null;if(C)E=C[c1(0x291)](':')[c1(0x189)](Number);const F=D?D[c1(0x291)](',')[c1(0x189)](G=>G[c1(0x18c)]())[c1(0x34c)+'r'](Boolean):[];g[c1(0x346)]({'targets':F,'layout':E,'defs':[]});}else{if(q[c1(0x13d)+c1(0x185)]('?')){const G=q[c1(0x259)](/^\?([^\(]+)\(([^)]+)\)/);if(!G)throw new Error(c1(0x437)+c1(0x48a)+c1(0x2a8)+c1(0x4b2)+q);const H=G[0x1][c1(0x18c)](),I=G[0x2][c1(0x18c)]();if(!I||!/^https?:\/\//[c1(0x17a)](I))throw new Error(c1(0x3c5)+c1(0x32b)+c1(0x3d9)+I);!g[c1(0x463)+'h']&&g[c1(0x346)]({'targets':[],'layout':null,'defs':[]}),g[g[c1(0x463)+'h']-0x1][c1(0x18b)][c1(0x346)]({'name':H,'url':I});}}}}if(h!==-0x1){const J=a[c1(0x332)+c1(0x2af)](h,j);f[c1(0x346)]({'text':J,'entities':b[c1(0x34c)+'r'](K=>K[c1(0x32d)+'t']>=h&&K[c1(0x32d)+'t']+K[c1(0x463)+'h']<=j)[c1(0x189)](K=>({...K,'offset':K[c1(0x32d)+'t']-h}))});}return{'filterNames':e,'responses':f,'buttons':g};}function ensureButtonLayout(a,b){const c2=a0bI;if(!a||a[c2(0x463)+'h']===0x0){if(b[c2(0x463)+'h']>0x8)throw new Error(c2(0x122)+c2(0x1a6)+c2(0x487)+c2(0x4b1)+'w');return[b[c2(0x463)+'h']];}const c=a[c2(0x214)+'e']((d,e)=>d+e,0x0);if(c!==b[c2(0x463)+'h'])throw new Error(c2(0x437)+c2(0x4af)+c2(0x3b5)+c2(0x26d)+c2(0x2fc)+b[c2(0x463)+'h']+(c2(0x1a6)+c2(0x446)+'s\x20')+c+(c2(0x44e)+c2(0x28a)+c2(0x3b8)+c2(0x2ca)+'.'));if(a[c2(0x1b6)](d=>d<0x1))throw new Error(c2(0x32e)+c2(0x290)+c2(0x353)+c2(0x190)+c2(0x197)+c2(0x308)+c2(0x3a8)+c2(0x153));if(Math[c2(0x278)](...a)>0x8)throw new Error(c2(0x122)+c2(0x1a6)+c2(0x487)+c2(0x4b1)+'w');return a;}function addFilter(a,b,c,d){const c3=a0bI,e=getChatFilters(a);if(!b[c3(0x463)+'h'])return;const f=b[0x0][c3(0x282)+c3(0x465)+'e']();let g=e[c3(0x48f)](f);(!g||g[c3(0x268)+c3(0x211)+'f'])&&(g={'responses':[],'buttons':[],'layout':[]});const h=new Set(g[c3(0x1f0)+c3(0x288)][c3(0x189)](j=>JSON[c3(0x3cb)+c3(0x48b)](j)));let i=![];for(const j of c){!h[c3(0x28c)](JSON[c3(0x3cb)+c3(0x48b)](j))&&(g[c3(0x1f0)+c3(0x288)][c3(0x346)](j),i=!![]);}if(d[c3(0x463)+'h']>0x0){const k=d[d[c3(0x463)+'h']-0x1];g[c3(0x3d3)+'ns']=k[c3(0x18b)][c3(0x189)](l=>({...l})),g[c3(0x348)+'t']=ensureButtonLayout(k[c3(0x348)+'t'],k[c3(0x18b)])[c3(0x207)]();}else{if(!g[c3(0x3d3)+'ns'])g[c3(0x3d3)+'ns']=[];if(!g[c3(0x348)+'t'])g[c3(0x348)+'t']=[];}e[c3(0x241)](f,g);for(const l of b){const m=l[c3(0x282)+c3(0x465)+'e']();m!==f&&e[c3(0x241)](m,{'__isAliasOf':f});}if(i){const n=a+'_'+f;userResponseIndex[c3(0x1d8)+'e'](n),markUserIndexChanged();}markFiltersChanged();}function setFilter(a,b,c,d){const c4=a0bI,e=getChatFilters(a);if(!b[c4(0x463)+'h'])return;const f=b[0x0][c4(0x282)+c4(0x465)+'e'](),g=new Set(b[c4(0x189)](j=>j[c4(0x282)+c4(0x465)+'e']()));for(const [j,k]of e[c4(0x229)+'es']()){(k[c4(0x268)+c4(0x211)+'f']===f||g[c4(0x28c)](j))&&e[c4(0x1d8)+'e'](j);}const h={'responses':[...c],'buttons':[],'layout':[]};if(d[c4(0x463)+'h']){const l=d[d[c4(0x463)+'h']-0x1];h[c4(0x3d3)+'ns']=l[c4(0x18b)][c4(0x189)](m=>({...m})),h[c4(0x348)+'t']=ensureButtonLayout(l[c4(0x348)+'t'],l[c4(0x18b)])[c4(0x207)]();}e[c4(0x241)](f,h);for(const m of b){const n=m[c4(0x282)+c4(0x465)+'e']();n!==f&&e[c4(0x241)](n,{'__isAliasOf':f});}const i=a+'_'+f;userResponseIndex[c4(0x1d8)+'e'](i),markFiltersChanged(),markUserIndexChanged();}function addResponsesOnly(a,b,c){const c5=a0bI,d=getChatFilters(a),e=b[c5(0x282)+c5(0x465)+'e']();let f=e;const g=d[c5(0x48f)](e);g&&g[c5(0x268)+c5(0x211)+'f']&&(f=g[c5(0x268)+c5(0x211)+'f']);const h=d[c5(0x48f)](f);if(!h||h[c5(0x268)+c5(0x211)+'f'])return 0x0;const i=h[c5(0x1f0)+c5(0x288)]||[],j=new Set(i[c5(0x189)](l=>JSON[c5(0x3cb)+c5(0x48b)](l)));let k=0x0;for(const l of c){!j[c5(0x28c)](JSON[c5(0x3cb)+c5(0x48b)](l))&&(i[c5(0x346)](l),k++);}h[c5(0x1f0)+c5(0x288)]=i;if(k>0x0){d[c5(0x241)](f,h);const m=a+'_'+f;userResponseIndex[c5(0x1d8)+'e'](m),markUserIndexChanged();}return k;}function addButtonsToFilter(a,b,c,d=[]){const c6=a0bI,f=getChatFilters(a),g=b[c6(0x282)+c6(0x465)+'e']();let h=g;const i=f[c6(0x48f)](g);i&&i[c6(0x268)+c6(0x211)+'f']&&(h=i[c6(0x268)+c6(0x211)+'f']);const j=f[c6(0x48f)](h);if(!j||j[c6(0x268)+c6(0x211)+'f'])return 0x0;const k=j[c6(0x3d3)+'ns']||[],l=new Set(k[c6(0x189)](n=>JSON[c6(0x3cb)+c6(0x48b)](n)));let m=0x0;for(const n of c){!l[c6(0x28c)](JSON[c6(0x3cb)+c6(0x48b)](n))&&(k[c6(0x346)](n),m++);}j[c6(0x3d3)+'ns']=k;if(d[c6(0x463)+'h']>0x0)try{j[c6(0x348)+'t']=ensureButtonLayout(d,k)[c6(0x207)]();}catch(o){error(c6(0x3c5)+c6(0x3bf)+c6(0x21b)+c6(0x133)+c6(0x3c4)+c6(0x119)+c6(0x46e)+b+':\x20'+o[c6(0x199)+'ge']+(c6(0x46f)+c6(0x434)+c6(0x253)+c6(0x3de)+c6(0x154))),j[c6(0x348)+'t']=[k[c6(0x463)+'h']];}else j[c6(0x348)+'t']=[k[c6(0x463)+'h']];return(m>0x0||d[c6(0x463)+'h']>0x0)&&(f[c6(0x241)](h,j),markFiltersChanged()),m;}function listFiltersWithResponses(a){const c7=a0bI,b=getChatFilters(a);if(!b||b[c7(0x48e)]===0x0)return[];const c=[],d=new Set();for(const [e,f]of b[c7(0x229)+'es']()){const g=e[c7(0x282)+c7(0x465)+'e']();if(f&&!f[c7(0x268)+c7(0x211)+'f']&&!d[c7(0x28c)](g)){const h=f,i=h[c7(0x1f0)+c7(0x288)]||[],j=[];for(const [l,m]of b[c7(0x229)+'es']()){m[c7(0x268)+c7(0x211)+'f']===g&&j[c7(0x346)](l);}let k=g;j[c7(0x463)+'h']>0x0&&(k=g+',\x20'+j[c7(0x2e5)]()[c7(0x1ba)](',\x20')),c[c7(0x346)]({'filter':k,'responses':i,'buttons':h[c7(0x3d3)+'ns']||[],'layout':h[c7(0x348)+'t']||[]}),d[c7(0x143)](g);}}return c;}function listButtons(a){const c8=a0bI,b=getChatFilters(a),c=new Map();for(const [e,g]of b[c8(0x229)+'es']()){if(g&&!g[c8(0x268)+c8(0x211)+'f']&&g[c8(0x3d3)+'ns']&&g[c8(0x3d3)+'ns'][c8(0x463)+'h']>0x0){const h=e,i=new Set([h]);for(const [j,k]of b[c8(0x229)+'es']()){k[c8(0x268)+c8(0x211)+'f']===h&&i[c8(0x143)](j);}for(const l of g[c8(0x3d3)+'ns']){!c[c8(0x28c)](l[c8(0x41e)])&&c[c8(0x241)](l[c8(0x41e)],{'url':l[c8(0x145)],'filters':new Set()});const m=c[c8(0x48f)](l[c8(0x41e)]);for(const n of i){m[c8(0x34c)+'rs'][c8(0x143)](n);}}}}const d=[];for(const [o,p]of c[c8(0x229)+'es']()){d[c8(0x346)]({'name':o,'url':p[c8(0x145)],'filters':Array[c8(0x3f7)](p[c8(0x34c)+'rs'])[c8(0x2e5)]()});}return d;}function delFilter(a,b){const c9=a0bI,c=getChatFilters(a),d=[],e=[],f=new Map();for(const g of b){const h=g[c9(0x282)+c9(0x465)+'e'](),i=c[c9(0x48f)](h);if(i){if(i[c9(0x268)+c9(0x211)+'f'])c[c9(0x1d8)+'e'](h),d[c9(0x346)](h);else{const j=[];for(const [l,m]of c[c9(0x229)+'es']()){m[c9(0x268)+c9(0x211)+'f']===h&&(j[c9(0x346)](l),c[c9(0x1d8)+'e'](l));}c[c9(0x1d8)+'e'](h),d[c9(0x346)](h,...j);const k=a+'_'+h;userResponseIndex[c9(0x1d8)+'e'](k);}}else{e[c9(0x346)](h);let n=Infinity,o=null;for(const p of c[c9(0x1ca)]()){const q=levenshteinDistance(h,p);q<n&&q>0x0&&(n=q,o=p);}o&&n<=LEVENSHTEIN_DISTANCE_THRESHOLD&&f[c9(0x241)](h,o);}}return(d[c9(0x463)+'h']>0x0||e[c9(0x463)+'h']>0x0)&&(markFiltersChanged(),markUserIndexChanged()),{'deleted':d,'notFound':e,'suggestions':f};}function normalizeText(a){const ca=a0bI;return(a||'')[ca(0x282)+ca(0x465)+'e']()[ca(0x459)+'ce'](/\s+/g,'\x20')[ca(0x18c)]();}function levenshteinDistance(c,d){const cb=a0bI;if(c[cb(0x463)+'h']===0x0)return d[cb(0x463)+'h'];if(d[cb(0x463)+'h']===0x0)return c[cb(0x463)+'h'];const e=[];for(let f=0x0;f<=d[cb(0x463)+'h'];f++)e[f]=[f];for(let g=0x0;g<=c[cb(0x463)+'h'];g++)e[0x0][g]=g;for(let h=0x1;h<=d[cb(0x463)+'h'];h++){for(let k=0x1;k<=c[cb(0x463)+'h'];k++){d[cb(0x3f5)+'t'](h-0x1)===c[cb(0x3f5)+'t'](k-0x1)?e[h][k]=e[h-0x1][k-0x1]:e[h][k]=Math[cb(0x1b8)](e[h-0x1][k-0x1]+0x1,e[h][k-0x1]+0x1,e[h-0x1][k]+0x1);}}return e[d[cb(0x463)+'h']][c[cb(0x463)+'h']];}function delResponse(a,b){const cc=a0bI,c=getChatFilters(a),d=normalizeText(b),e=[];for(const [f,g]of c[cc(0x229)+'es']()){if(g&&!g[cc(0x268)+cc(0x211)+'f']){const h=g[cc(0x1f0)+cc(0x288)]||[];for(let j=0x0;j<h[cc(0x463)+'h'];j++){normalizeText(h[j][cc(0x36a)])===d&&e[cc(0x346)]({'filterName':f,'responseIndex':j,'responseText':h[j][cc(0x36a)]});}}}if(e[cc(0x463)+'h']===0x0){let k=null,l=Infinity,m=null;for(const [n,o]of c[cc(0x229)+'es']()){if(o&&!o[cc(0x268)+cc(0x211)+'f']){const p=o[cc(0x1f0)+cc(0x288)]||[];for(const q of p){const r=levenshteinDistance(normalizeText(q[cc(0x36a)]),d);r<l&&r>0x0&&(l=r,k=q[cc(0x36a)],m=n);}}}return k&&l<=LEVENSHTEIN_DISTANCE_THRESHOLD?{'status':cc(0x49b)+cc(0x35c),'message':cc(0x419)+cc(0x34e)+cc(0x264)+cc(0x12d)+cc(0x2c4)+cc(0x454)+cc(0x33a)+cc(0x1da)+escapeHtml(k)+(cc(0x1a8)+cc(0x29e)+cc(0x14c)+cc(0x46e)+cc(0x21d))+escapeHtml(m)+(cc(0x162)+')?'),'parse_mode':cc(0x3ef)}:{'status':cc(0x1ee)+cc(0x277),'message':cc(0x4ad)+cc(0x1c9)+cc(0x264)+cc(0x479)+cc(0x482)};}else{if(e[cc(0x463)+'h']===0x1){const s=e[0x0],t=c[cc(0x48f)](s[cc(0x34c)+cc(0x2b0)]);t[cc(0x1f0)+cc(0x288)][cc(0x2d5)+'e'](s[cc(0x1f0)+cc(0x19d)+cc(0x261)],0x1),c[cc(0x241)](s[cc(0x34c)+cc(0x2b0)],t);const u=a+'_'+s[cc(0x34c)+cc(0x2b0)];return userResponseIndex[cc(0x1d8)+'e'](u),markFiltersChanged(),markUserIndexChanged(),{'status':cc(0x1d8)+'ed','message':cc(0x438)+cc(0x42f)+cc(0x21a)+cc(0x219)+cc(0x168)+cc(0x383)+'\x20\x22'+s[cc(0x34c)+cc(0x2b0)]+'\x22.','filter':s[cc(0x34c)+cc(0x2b0)]};}else return{'status':cc(0x354)+cc(0x42d),'message':cc(0x3a5)+cc(0x41f)+cc(0x212)+cc(0x181)+cc(0x423)+cc(0x470)+cc(0x409)+cc(0x20a)+cc(0x357)+cc(0x14e)+cc(0x21a)+cc(0x1aa),'matches':e};}}function delButton(a,b,c=null){const cd=a0bI,d=getChatFilters(a),e=[],f=[];for(const [g,h]of d[cd(0x229)+'es']()){if(h&&!h[cd(0x268)+cd(0x211)+'f']){if(c&&g!==c)continue;const i=h[cd(0x3d3)+'ns']||[],j=i[cd(0x463)+'h'];h[cd(0x3d3)+'ns']=i[cd(0x34c)+'r'](k=>k[cd(0x41e)]!==b),h[cd(0x3d3)+'ns'][cd(0x463)+'h']<j&&(h[cd(0x348)+'t']=[h[cd(0x3d3)+'ns'][cd(0x463)+'h']],d[cd(0x241)](g,h),e[cd(0x346)](g));}}return e[cd(0x463)+'h']>0x0?(markFiltersChanged(),{'deleted':!![],'from':e}):{'deleted':![],'notFound':!![]};}function generateAdminPanelKeyboard(a){const ce=a0bI;return new InlineKeyboard()[ce(0x36a)](ce(0x350)+ce(0x177)+ce(0x134),ADMIN_CALLBACK_PREFIX+(ce(0x34a)+ce(0x383)+ce(0x44b))+a)[ce(0x36a)](ce(0x29c)+ce(0x2ea)+ce(0x344),ADMIN_CALLBACK_PREFIX+(ce(0x243)+ce(0x1c0)+ce(0x44b))+a)[ce(0x382)]()[ce(0x36a)](ce(0x3bd)+ce(0x3f0)+ce(0x383),ADMIN_CALLBACK_PREFIX+(ce(0x362)+ce(0x39a)+ce(0x383)+'::')+a)[ce(0x36a)](ce(0x3bd)+ce(0x161)+ce(0x29d)+'se',ADMIN_CALLBACK_PREFIX+(ce(0x362)+ce(0x205)+ce(0x29d)+ce(0x18f))+a)[ce(0x36a)](ce(0x3bd)+ce(0x231)+ce(0x1c0),ADMIN_CALLBACK_PREFIX+(ce(0x362)+ce(0x39a)+ce(0x3d3)+ce(0x405))+a)[ce(0x382)]()[ce(0x36a)](ce(0x2c0)+ce(0x1b0)+ce(0x1f4),ADMIN_CALLBACK_PREFIX+(ce(0x362)+ce(0x45b)+ce(0x29d)+ce(0x18f))+a)[ce(0x36a)](ce(0x2c0)+ce(0x3e7)+ce(0x440),ADMIN_CALLBACK_PREFIX+(ce(0x362)+ce(0x23d)+ce(0x1c0)+'::')+a)[ce(0x382)]()[ce(0x36a)](ce(0x2b9)+ce(0x39f)+ce(0x15e),ADMIN_CALLBACK_PREFIX+(ce(0x2dd)+ce(0x23c))+a);}function generateCancelKeyboard(a){const cf=a0bI;return new InlineKeyboard()[cf(0x36a)](cf(0x18a)+cf(0x1e0),ADMIN_CALLBACK_PREFIX+(cf(0x360)+':')+a);}async function generateFilterListPage(a,b=0x1){const cg=a0bI,c=listFiltersWithResponses(a);if(!c[cg(0x463)+'h'])return{'text':await applyFont(name,cg(0x1d6)+cg(0x396)+cg(0x364)),'reply_markup':generateAdminPanelKeyboard(a),'parse_mode':cg(0x3ef),'disable_web_page_preview':!![]};const d=c[cg(0x463)+'h'],e=Math[cg(0x11a)](d/FILTERS_PER_PAGE),f=Math[cg(0x278)](0x1,Math[cg(0x1b8)](b,e)),g=(f-0x1)*FILTERS_PER_PAGE,h=c[cg(0x207)](g,g+FILTERS_PER_PAGE);let i=cg(0x356)+await applyFont(name,cg(0x246)+cg(0x3d1)+cg(0x11b))+(cg(0x183)+cg(0x408)+cg(0x356))+f+(cg(0x3a1)+cg(0x356))+e+(cg(0x183)+'\x0a'),j=i[cg(0x463)+'h'];for(const m of h){let n=cg(0x356)+await applyFont(name,escapeHtml(m[cg(0x34c)+'r']))+(cg(0x256)+'\x0a');n+=cg(0x385)+cg(0x285)+cg(0x11c)+cg(0x194);const o=m[cg(0x1f0)+cg(0x288)][cg(0x207)](0x0,0x3);for(const p of o){let q=p[cg(0x36a)],r=p[cg(0x414)+cg(0x2fa)];q[cg(0x463)+'h']>0x64&&(q=q[cg(0x332)+cg(0x2af)](0x0,0x64)+cg(0x176),r=p[cg(0x414)+cg(0x2fa)][cg(0x34c)+'r'](t=>{const ch=cg,u=t[ch(0x32d)+'t']+t[ch(0x463)+'h'];return t[ch(0x32d)+'t']<0x64&&u<=0x64;}));const s=formatTextWithEntities(q,r);n+=cg(0x1bb)+'>'+s+cg(0x1e1);}m[cg(0x1f0)+cg(0x288)][cg(0x463)+'h']>0x3&&(n+=cg(0x125)+'.'+(m[cg(0x1f0)+cg(0x288)][cg(0x463)+'h']-0x3)+(cg(0x1c3)+'\x0a'));if(m[cg(0x3d3)+'ns'][cg(0x463)+'h']>0x0){n+=cg(0x3c1)+cg(0x457)+cg(0x191)+'\x0a';for(const t of m[cg(0x3d3)+'ns'][cg(0x207)](0x0,0x3)){n+=cg(0x14f)+t[cg(0x41e)]+'\x20('+t[cg(0x145)][cg(0x332)+cg(0x2af)](0x0,0x14)+cg(0x488);}m[cg(0x3d3)+'ns'][cg(0x463)+'h']>0x3&&(n+=cg(0x125)+'.'+(m[cg(0x3d3)+'ns'][cg(0x463)+'h']-0x3)+(cg(0x1c3)+'\x0a'));}n+='\x0a';if(j+n[cg(0x463)+'h']>MAX_MESSAGE_LENGTH){i+=cg(0x260)+cg(0x42a)+cg(0x345)+cg(0x2b4)+cg(0x1e3);break;}i+=n,j+=n[cg(0x463)+'h'];}const k=new InlineKeyboard(),l=[];return f>0x1&&l[cg(0x346)](InlineKeyboard[cg(0x36a)](cg(0x397)+'v',CALLBACK_PREFIX+(cg(0x33f)+cg(0x329))+a+'::'+(f-0x1))),l[cg(0x346)](InlineKeyboard[cg(0x36a)](f+'/'+e,CALLBACK_PREFIX+cg(0x21c))),f<e&&l[cg(0x346)](InlineKeyboard[cg(0x36a)](cg(0x24c)+'»',CALLBACK_PREFIX+(cg(0x33f)+cg(0x329))+a+'::'+(f+0x1))),l[cg(0x463)+'h']>0x0&&k[cg(0x382)](...l),k[cg(0x382)](InlineKeyboard[cg(0x36a)](cg(0x398)+'k',ADMIN_CALLBACK_PREFIX+(cg(0x360)+':')+a)),{'text':i[cg(0x18c)](),'reply_markup':k,'parse_mode':cg(0x3ef),'disable_web_page_preview':!![]};}async function generateButtonListPage(a,b=0x1){const ci=a0bI,c=listButtons(a);if(!c[ci(0x463)+'h'])return{'text':await applyFont(name,ci(0x381)+ci(0x457)+ci(0x364)),'reply_markup':generateAdminPanelKeyboard(a),'parse_mode':ci(0x3ef),'disable_web_page_preview':!![]};const d=c[ci(0x463)+'h'],f=Math[ci(0x11a)](d/BUTTONS_PER_PAGE),g=Math[ci(0x278)](0x1,Math[ci(0x1b8)](b,f)),h=(g-0x1)*BUTTONS_PER_PAGE,i=c[ci(0x207)](h,h+BUTTONS_PER_PAGE);let j=ci(0x356)+await applyFont(name,ci(0x437)+'ns')+(ci(0x183)+ci(0x408)+ci(0x356))+g+(ci(0x3a1)+ci(0x356))+f+(ci(0x183)+'\x0a'),k=j[ci(0x463)+'h'];for(const n of i){const o=escapeHtml(n[ci(0x41e)]);let p;try{const v=new URL(n[ci(0x145)]);p=v[ci(0x267)+ci(0x40d)]+(v[ci(0x235)+ci(0x40d)]!=='/'?v[ci(0x235)+ci(0x40d)][ci(0x332)+ci(0x2af)](0x0,0xf)+ci(0x176):'');}catch(w){p=n[ci(0x145)][ci(0x463)+'h']>0x1e?n[ci(0x145)][ci(0x332)+ci(0x2af)](0x0,0x1b)+ci(0x176):n[ci(0x145)];}const q=escapeHtml(p),r=0x3;let s;n[ci(0x34c)+'rs'][ci(0x463)+'h']<=r?s=n[ci(0x34c)+'rs'][ci(0x1ba)](',\x20'):s=n[ci(0x34c)+'rs'][ci(0x207)](0x0,r)[ci(0x1ba)](',\x20')+(ci(0x2ba)+(n[ci(0x34c)+'rs'][ci(0x463)+'h']-r)+ci(0x1c3));const t=escapeHtml(s),u=ci(0x31c)+await applyFont(name,o)+(ci(0x183)+ci(0x1ae)+ci(0x17c))+q+(ci(0x1a8)+ci(0x49e))+t+'\x0a\x0a';if(k+u[ci(0x463)+'h']>MAX_MESSAGE_LENGTH){j+=ci(0x260)+ci(0x295)+ci(0x421)+ci(0x2df)+'d)';break;}j+=u,k+=u[ci(0x463)+'h'];}const l=new InlineKeyboard(),m=[];return g>0x1&&m[ci(0x346)](InlineKeyboard[ci(0x36a)](ci(0x397)+'v',CALLBACK_PREFIX+(ci(0x2a3)+'::')+a+'::'+(g-0x1))),m[ci(0x346)](InlineKeyboard[ci(0x36a)](g+'/'+f,CALLBACK_PREFIX+ci(0x21c))),g<f&&m[ci(0x346)](InlineKeyboard[ci(0x36a)](ci(0x24c)+'»',CALLBACK_PREFIX+(ci(0x2a3)+'::')+a+'::'+(g+0x1))),m[ci(0x463)+'h']>0x0&&l[ci(0x382)](...m),l[ci(0x382)](InlineKeyboard[ci(0x36a)](ci(0x398)+'k',ADMIN_CALLBACK_PREFIX+(ci(0x360)+':')+a)),{'text':j[ci(0x18c)](),'reply_markup':l,'parse_mode':ci(0x3ef),'disable_web_page_preview':!![]};}function matchFilter(a,b){const cj=a0bI,c=b[cj(0x282)+cj(0x465)+'e'](),d=new Map();for(const [i,j]of a[cj(0x229)+'es']()){const k=i[cj(0x282)+cj(0x465)+'e']();let l=j[cj(0x268)+cj(0x211)+'f']?j[cj(0x268)+cj(0x211)+'f']:k;d[cj(0x241)](k,l);}const e=/[\p{L}\p{N}_]+/gu;let f,g=null,h=Infinity;while((f=e[cj(0x1b9)](c))!==null){const m=f[0x0],n=f[cj(0x38a)];d[cj(0x28c)](m)&&n<h&&(h=n,g={'word':m,'master':d[cj(0x48f)](m)});}return g?g[cj(0x1f2)+'r']:null;}export async function onMessage(a){const ck=a0bI;if(!botApi)botApi=a[ck(0x3ab)];const b=a[ck(0x199)+'ge']?.[ck(0x36a)]||'',c=a[ck(0x2a2)][ck(0x213)],d=a[ck(0x2a2)]['id'],f=a[ck(0x3f7)]?.['id'],g=a[ck(0x199)+'ge']?.[ck(0x414)+ck(0x2fa)]||[],h=b[ck(0x282)+ck(0x465)+'e']()[ck(0x291)]('\x20')[0x0],j=new Set([ck(0x218)+'er',ck(0x42c)+ck(0x383),ck(0x2bc)+ck(0x34c)+'r',ck(0x37b)+ck(0x29d)+'se',ck(0x42c)+ck(0x3d3)+'n',ck(0x369)+ck(0x3d3)+'ns',ck(0x1c8)+'el']);if(j[ck(0x28c)](h)&&!isAdmin(a))return a[ck(0x36c)](await applyFont(name,ck(0x1a2)+ck(0x1ea)+ck(0x2eb)+'d.'));if(h===ck(0x1c8)+'el')return f&&pendingAdminActions[ck(0x28c)](f)?(pendingAdminActions[ck(0x1d8)+'e'](f),a[ck(0x36c)](await applyFont(name,ck(0x20d)+ck(0x36f)+ck(0x2e9)+ck(0x223)+ck(0x1e9)+'d.'))):a[ck(0x36c)](await applyFont(name,ck(0x416)+ck(0x40b)+ck(0x21f)+ck(0x127)+ck(0x395)+ck(0x2b7)));if(f&&pendingAdminActions[ck(0x28c)](f)){const k=pendingAdminActions[ck(0x48f)](f);if(Date[ck(0x47e)]()-k['ts']>PENDING_ACTION_TTL_MS)return pendingAdminActions[ck(0x1d8)+'e'](f),a[ck(0x36c)](await applyFont(name,ck(0x19c)+ck(0x202)+ck(0x393)+'d.'));const l=k[ck(0x3a2)+'d'];switch(k[ck(0x213)]){case ck(0x1d8)+ck(0x2d1)+ck(0x442)+ck(0x2f8):{const m=b[ck(0x18c)]()[ck(0x291)](',')[ck(0x189)](q=>q[ck(0x18c)]())[ck(0x34c)+'r'](Boolean);if(!m[ck(0x463)+'h'])return a[ck(0x36c)](await applyFont(name,ck(0x126)+ck(0x480)+ck(0x46e)+ck(0x2f2)+ck(0x294)+ck(0x124)+ck(0x1df)+ck(0x11e)),{'reply_markup':generateCancelKeyboard(l)});const n=delFilter(l,m);let o='';n[ck(0x1d8)+'ed'][ck(0x463)+'h']>0x0&&(o+=ck(0x299)+ck(0x31a)+'\x20'+n[ck(0x1d8)+'ed'][ck(0x1ba)](',\x20')+'\x0a');if(n[ck(0x44d)+ck(0x309)][ck(0x463)+'h']>0x0){o+=ck(0x3ca)+ck(0x1a4)+ck(0x26b)+n[ck(0x44d)+ck(0x309)][ck(0x1ba)](',\x20')+'\x0a';for(const q of n[ck(0x44d)+ck(0x309)]){n[ck(0x49b)+ck(0x35c)+'s'][ck(0x28c)](q)&&(o+=ck(0x49d)+ck(0x29b)+ck(0x3db)+'\x20'+n[ck(0x49b)+ck(0x35c)+'s'][ck(0x48f)](q)+'?\x0a');}}let p=ck(0x1b3)+l;try{if(l!==d){const r=await botApi[ck(0x402)+'at'](l);p=ck(0x356)+escapeHtml(r[ck(0x3c6)]||ck(0x2f9)+'wn')+ck(0x167);}}catch(s){}await a[ck(0x36c)](''+await applyFont(name,ck(0x246)+ck(0x1ac)+ck(0x49c)+ck(0x17b)+ck(0x431)+'r\x20')+p+await applyFont(name,':\x0a')+o,{'parse_mode':ck(0x3ef)}),pendingAdminActions[ck(0x1d8)+'e'](f);break;}case ck(0x1d8)+ck(0x156)+ck(0x42f)+ck(0x3b6)+'pt':{const t=b[ck(0x18c)]();if(!t)return a[ck(0x36c)](await applyFont(name,ck(0x126)+ck(0x37f)+ck(0x25c)+ck(0x29d)+ck(0x1ff)+ck(0x131)),{'reply_markup':generateCancelKeyboard(l)});const u=delResponse(l,t);if(u[ck(0x12a)+'s']===ck(0x354)+ck(0x42d)){pendingAdminActions[ck(0x241)](f,{'type':ck(0x1d8)+ck(0x156)+ck(0x42f)+ck(0x4b3)+'ct','chatId':l,'matches':u[ck(0x259)+'es'],'ts':Date[ck(0x47e)]()});let w=ck(0x3a5)+ck(0x41f)+ck(0x212)+ck(0x181)+ck(0x429);return u[ck(0x259)+'es'][ck(0x374)+'ch']((x,y)=>{const cl=ck,z=x[cl(0x1f0)+cl(0x34f)+'xt'][cl(0x463)+'h']>0x32?x[cl(0x1f0)+cl(0x34f)+'xt'][cl(0x332)+cl(0x2af)](0x0,0x2f)+cl(0x176):x[cl(0x1f0)+cl(0x34f)+'xt'];w+=y+0x1+(cl(0x1f7)+cl(0x28e))+x[cl(0x34c)+cl(0x2b0)]+cl(0x32a)+z+'\x22\x0a';}),w+=ck(0x400)+ck(0x4a2)+ck(0x475)+ck(0x31b)+ck(0x249)+ck(0x237)+ck(0x1f0)+ck(0x2e6)+ck(0x1dd)+ck(0x310),a[ck(0x36c)](w,{'reply_markup':generateCancelKeyboard(l)});}let v=ck(0x1b3)+l;try{if(l!==d){const x=await botApi[ck(0x402)+'at'](l);v=ck(0x356)+escapeHtml(x[ck(0x3c6)]||ck(0x2f9)+'wn')+ck(0x167);}}catch(y){}await a[ck(0x36c)](''+await applyFont(name,ck(0x2f5)+ck(0x43c)+ck(0x2ae)+ck(0x37e)+ck(0x2bb)+ck(0x19e))+v+await applyFont(name,':\x0a')+u[ck(0x199)+'ge'],{'parse_mode':u[ck(0x164)+ck(0x448)]||ck(0x3ef)}),pendingAdminActions[ck(0x1d8)+'e'](f);break;}case ck(0x1d8)+ck(0x156)+ck(0x42f)+ck(0x4b3)+'ct':{if(!k[ck(0x259)+'es']||!Array[ck(0x11f)+'ay'](k[ck(0x259)+'es']))return pendingAdminActions[ck(0x1d8)+'e'](f),a[ck(0x36c)](ck(0x491)+ck(0x1c6)+ck(0x26f)+ck(0x25f)+ck(0x361)+ck(0x453)+ck(0x144)+ck(0x338)+ck(0x165)+ck(0x222)+ck(0x174)+ck(0x1cc)+ck(0x2ae)+ck(0x31f)+ck(0x1d3)+'.',{'reply_markup':generateCancelKeyboard(l)});const z=parseInt(b[ck(0x18c)]());if(isNaN(z)||z<0x1||z>k[ck(0x259)+'es'][ck(0x463)+'h'])return a[ck(0x36c)](ck(0x3c5)+ck(0x25f)+ck(0x361)+ck(0x3b9)+ck(0x470)+ck(0x276)+ck(0x32c)+'.',{'reply_markup':generateCancelKeyboard(l)});const A=k[ck(0x259)+'es'][z-0x1],B=getChatFilters(l)[ck(0x48f)](A[ck(0x34c)+ck(0x2b0)]);B[ck(0x1f0)+ck(0x288)][ck(0x2d5)+'e'](A[ck(0x1f0)+ck(0x19d)+ck(0x261)],0x1);const C=l+'_'+A[ck(0x34c)+ck(0x2b0)];userResponseIndex[ck(0x1d8)+'e'](C),markFiltersChanged(),markUserIndexChanged(),await a[ck(0x36c)](ck(0x438)+ck(0x42f)+ck(0x21a)+ck(0x219)+ck(0x168)+ck(0x383)+'\x20\x22'+A[ck(0x34c)+ck(0x2b0)]+'\x22.'),pendingAdminActions[ck(0x1d8)+'e'](f);break;}case ck(0x1d8)+ck(0x158)+ck(0x3f3)+ck(0x2f8):{const D=b[ck(0x18c)]();if(!D)return a[ck(0x36c)](await applyFont(name,ck(0x126)+ck(0x3aa)+ck(0x2ab)+ck(0x461)),{'reply_markup':generateCancelKeyboard(l)});const E=listButtons(l),F=E[ck(0x1b6)](I=>I[ck(0x41e)]===D);if(!F){let I='';for(const J of E){const K=levenshteinDistance(D,J[ck(0x41e)]);K<=LEVENSHTEIN_DISTANCE_THRESHOLD&&(I+=ck(0x49d)+ck(0x29b)+ck(0x3db)+'\x20'+J[ck(0x41e)]+'?\x0a');}return a[ck(0x36c)](ck(0x386)+ck(0x2c7)+ck(0x44c)+ck(0x469)+(I||ck(0x1f9)+ck(0x45f)+ck(0x1a6)+ck(0x1ce)+ck(0x2b3)),{'reply_markup':generateCancelKeyboard(l)});}const G=[],H=getChatFilters(l);for(const [L,M]of H[ck(0x229)+'es']()){if(M&&!M[ck(0x268)+ck(0x211)+'f']){const N=M[ck(0x3d3)+'ns']?.[ck(0x1b6)](O=>O[ck(0x41e)]===D);N&&G[ck(0x346)](L);}}pendingAdminActions[ck(0x241)](f,{'type':ck(0x1d8)+ck(0x158)+ck(0x472)+ck(0x2c2),'chatId':l,'buttonName':D,'matches':G,'ts':Date[ck(0x47e)]()});if(G[ck(0x463)+'h']===0x0)return pendingAdminActions[ck(0x1d8)+'e'](f),a[ck(0x36c)](ck(0x2aa)+ck(0x23e)+ck(0x1d4)+ck(0x391)+ck(0x437)+ck(0x247)+ck(0x1a4)+ck(0x175)+ck(0x47a)+ck(0x383)+ck(0x2fb)+ck(0x22b)+ck(0x30f)+ck(0x35a)+ck(0x318),{'reply_markup':generateCancelKeyboard(l)});else{if(G[ck(0x463)+'h']===0x1){const O=delButton(l,D,G[0x0]);O[ck(0x1d8)+'ed']?await a[ck(0x36c)](ck(0x2e3)+ck(0x30b)+ck(0x38c)+ck(0x497)+ck(0x2d2)+ck(0x4a6)+G[0x0]+'\x22.'):await a[ck(0x36c)](ck(0x15c)+ck(0x22d)+ck(0x1dd)+ck(0x22e)+ck(0x1c0)+'.'),pendingAdminActions[ck(0x1d8)+'e'](f);}else{let P=ck(0x437)+ck(0x418)+ck(0x325)+ck(0x2fd)+ck(0x331)+ck(0x34c)+ck(0x270);G[ck(0x374)+'ch']((Q,R)=>{P+=R+0x1+'.\x20'+Q+'\x0a';}),P+=ck(0x400)+ck(0x4a2)+ck(0x475)+ck(0x31b)+ck(0x249)+ck(0x237)+ck(0x34c)+ck(0x148)+ck(0x1d8)+ck(0x1cb)+'m.',await a[ck(0x36c)](P,{'reply_markup':generateCancelKeyboard(l)});}}break;}case ck(0x1d8)+ck(0x158)+ck(0x472)+ck(0x2c2):{if(!k[ck(0x259)+'es']||!Array[ck(0x11f)+'ay'](k[ck(0x259)+'es']))return pendingAdminActions[ck(0x1d8)+'e'](f),a[ck(0x36c)](ck(0x491)+ck(0x1c6)+ck(0x26f)+ck(0x25f)+ck(0x361)+ck(0x453)+ck(0x144)+ck(0x338)+ck(0x165)+ck(0x222)+ck(0x174)+ck(0x1cc)+ck(0x2ae)+ck(0x31f)+ck(0x1d3)+'.',{'reply_markup':generateCancelKeyboard(l)});const Q=parseInt(b[ck(0x18c)]());if(isNaN(Q)||Q<0x1||Q>k[ck(0x259)+'es'][ck(0x463)+'h'])return a[ck(0x36c)](ck(0x3c5)+ck(0x25f)+ck(0x361)+ck(0x3b9)+ck(0x470)+ck(0x276)+ck(0x32c)+'.',{'reply_markup':generateCancelKeyboard(l)});const R=k[ck(0x259)+'es'][Q-0x1],S=delButton(l,k[ck(0x3d3)+ck(0x33b)],R);S[ck(0x1d8)+'ed']?await a[ck(0x36c)](ck(0x2e3)+ck(0x30b)+ck(0x38c)+ck(0x497)+ck(0x2d2)+ck(0x4a6)+R+'\x22.'):await a[ck(0x36c)](ck(0x15c)+ck(0x22d)+ck(0x1dd)+ck(0x22e)+ck(0x1c0)+'.');pendingAdminActions[ck(0x1d8)+'e'](f);break;}case ck(0x2cf)+ck(0x29d)+ck(0x462)+ck(0x21e):{const T=b[ck(0x291)]('\x0a'),U=T[0x0][ck(0x18c)](),V=T[ck(0x207)](0x1)[ck(0x34c)+'r'](X=>X[ck(0x13d)+ck(0x185)]('!'))[ck(0x189)](X=>X[ck(0x207)](0x1)[ck(0x18c)]());if(!U||V[ck(0x463)+'h']===0x0)return a[ck(0x36c)](ck(0x4b0)+ck(0x34b)+ck(0x157)+ck(0x1c4)+ck(0x1b0)+ck(0x2e8)+ck(0x3d7)+ck(0x29d)+ck(0x3e3)+ck(0x176),{'reply_markup':generateCancelKeyboard(l)});const W=addResponsesOnly(l,U,V[ck(0x189)](X=>({'text':X,'entities':[]})));W>0x0?await a[ck(0x36c)](ck(0x1bd)+ck(0x496)+W+(ck(0x163)+ck(0x1fb)+ck(0x182)+ck(0x341)+ck(0x2d3))+U+'\x22.'):await a[ck(0x36c)](ck(0x4ad)+ck(0x334)+ck(0x29d)+ck(0x120)+ck(0x3a7)+ck(0x2b6)+ck(0x411)+ck(0x244)+ck(0x407)+ck(0x435));pendingAdminActions[ck(0x1d8)+'e'](f);break;}case ck(0x1a7)+ck(0x1c0)+ck(0x3b6)+'pt':{const X=b[ck(0x291)]('\x0a')[ck(0x189)](a3=>a3[ck(0x18c)]()),Y=X[0x0];let Z=[],a0=[],a1=0x1;if(X[ck(0x463)+'h']>0x1){const a3=X[0x1][ck(0x282)+ck(0x465)+'e'](),a4=a3[ck(0x259)](/^(?:button\s*)?([0-9:]+)$/);a4&&(a0=a4[0x1][ck(0x291)](':')[ck(0x189)](Number),a1=0x2);}for(let a5=a1;a5<X[ck(0x463)+'h'];a5++){const a6=X[a5];if(a6[ck(0x13d)+ck(0x185)]('?')){const a7=a6[ck(0x259)](/^\?([^\(]+)\(([^)]+)\)/);if(a7){const a8=a7[0x1][ck(0x18c)](),a9=a7[0x2][ck(0x18c)]();a9&&/^https?:\/\//[ck(0x17a)](a9)?Z[ck(0x346)]({'name':a8,'url':a9}):error(ck(0x3c5)+ck(0x32b)+ck(0x323)+ck(0x1a7)+ck(0x1c0)+ck(0x3b6)+ck(0x317)+a9);}}}if(!Y||Z[ck(0x463)+'h']===0x0)return a[ck(0x36c)](ck(0x4b0)+ck(0x34b)+ck(0x157)+ck(0x48d)+ck(0x380)+ck(0x1d9)+ck(0x3d3)+ck(0x483)+ck(0x221)+ck(0x348)+ck(0x195)+ck(0x336)+ck(0x3f2)+ck(0x3e7)+ck(0x3c8)+ck(0x137)+ck(0x466)+ck(0x206)+ck(0x30c)+ck(0x499)+ck(0x492)+ck(0x406)+ck(0x12b)+ck(0x1de)+ck(0x316),{'reply_markup':generateCancelKeyboard(l)});const a2=addButtonsToFilter(l,Y,Z,a0);a2>0x0||a0[ck(0x463)+'h']>0x0?await a[ck(0x36c)](ck(0x1bd)+ck(0x496)+a2+(ck(0x1a6)+ck(0x303)+ck(0x151)+ck(0x2ef)+ck(0x224)+ck(0x3de)+ck(0x2e7)+ck(0x26e)+ck(0x4a6))+Y+'\x22.'):await a[ck(0x36c)](ck(0x4ad)+ck(0x1ed)+ck(0x1c0)+ck(0x3da)+ck(0x489)+ck(0x149)+ck(0x23a)+ck(0x45a)+ck(0x372)+ck(0x193)+ck(0x1bf)+ck(0x436)+ck(0x32b)+ck(0x44f)+ck(0x3c9)+ck(0x186)+ck(0x43b)+ck(0x3dc)+ck(0x318));pendingAdminActions[ck(0x1d8)+'e'](f);break;}}return;}if(h===ck(0x218)+'er'){if(b[ck(0x18c)]()===ck(0x218)+'er'){let aa=d,ab=ck(0x160)+ck(0x2d0);if(c===ck(0x2f6)+'te'){const ae=await getDefault();if(!ae)return a[ck(0x36c)](await applyFont(name,ck(0x4ad)+ck(0x1e5)+ck(0x25d)+ck(0x493)+ck(0x2e4)+ck(0x443)));const af=await getConnection(ae);if(!af)return a[ck(0x36c)](await applyFont(name,ck(0x2de)+ck(0x3ae)+ck(0x2d0)+'\x20\x27'+ae+(ck(0x2ad)+ck(0x1a4)+'d.')));aa=af;try{const ag=await botApi[ck(0x402)+'at'](aa);ab=ck(0x356)+escapeHtml(ag[ck(0x3c6)]||ck(0x2f9)+ck(0x269)+'at')+ck(0x167);}catch(ah){ab=ck(0x458)+'>'+aa+ck(0x167);}}else try{const ai=await botApi[ck(0x402)+'at'](aa);ab=ck(0x356)+escapeHtml(ai[ck(0x3c6)]||ck(0x2f9)+ck(0x269)+'at')+ck(0x167);}catch(aj){}const ac=generateAdminPanelKeyboard(aa),ad=''+await applyFont(name,ck(0x246)+ck(0x3b4)+ck(0x2da)+ck(0x17e)+ck(0x352))+ab;return a[ck(0x36c)](ad,{'reply_markup':ac,'parse_mode':ck(0x3ef)});}try{const ak=parseFilterCommandAndContent(b,g);if(!ak[ck(0x34c)+ck(0x2b0)+'s'][ck(0x463)+'h'])return a[ck(0x36c)](await applyFont(name,ck(0x17d)+ck(0x3ea)+ck(0x20f)+ck(0x3c7)+ck(0x3b3)+ck(0x4ac)));if(!ak[ck(0x1f0)+ck(0x288)][ck(0x463)+'h'])return a[ck(0x36c)](await applyFont(name,ck(0x17d)+ck(0x3ea)+ck(0x20f)+ck(0x335)+ck(0x22c)+ck(0x410)+ck(0x1f0)+ck(0x36e)));let al=d,am=ck(0x160)+ck(0x2d0);if(c===ck(0x2f6)+'te'){const aq=await getDefault();if(!aq)return a[ck(0x36c)](await applyFont(name,ck(0x4ad)+ck(0x1e5)+ck(0x25d)+ck(0x493)+ck(0x2e4)+ck(0x443)));const ar=await getConnection(aq);if(!ar)return a[ck(0x36c)](await applyFont(name,ck(0x2de)+ck(0x3ae)+ck(0x2d0)+'\x20\x27'+aq+(ck(0x2ad)+ck(0x1a4)+'d.')));al=ar;try{const as=await botApi[ck(0x402)+'at'](al);am=ck(0x356)+escapeHtml(as[ck(0x3c6)]||ck(0x2f9)+ck(0x269)+'at')+ck(0x167);}catch(at){am=ck(0x458)+'>'+al+ck(0x167);}}else try{const au=await botApi[ck(0x402)+'at'](al);am=ck(0x356)+escapeHtml(au[ck(0x3c6)]||ck(0x2f9)+ck(0x269)+'at')+ck(0x167);}catch(av){}addFilter(al,ak[ck(0x34c)+ck(0x2b0)+'s'],ak[ck(0x1f0)+ck(0x288)],ak[ck(0x3d3)+'ns']);let an='';for(let aw=0x0;aw<Math[ck(0x1b8)](0x2,ak[ck(0x1f0)+ck(0x288)][ck(0x463)+'h']);aw++){const ax=ak[ck(0x1f0)+ck(0x288)][aw][ck(0x36a)][ck(0x463)+'h']>0x32?ak[ck(0x1f0)+ck(0x288)][aw][ck(0x36a)][ck(0x332)+ck(0x2af)](0x0,0x2f)+ck(0x176):ak[ck(0x1f0)+ck(0x288)][aw][ck(0x36a)];an+=ck(0x14f)+ax+'\x0a';}ak[ck(0x1f0)+ck(0x288)][ck(0x463)+'h']>0x2&&(an+=ck(0x125)+ck(0x3a6)+(ak[ck(0x1f0)+ck(0x288)][ck(0x463)+'h']-0x2)+(ck(0x1c3)+'\x0a'));const ao=ak[ck(0x34c)+ck(0x2b0)+'s'][ck(0x1ba)](',\x20'),ap=ak[ck(0x3d3)+'ns'][ck(0x463)+'h']>0x0?ck(0x1d5)+ak[ck(0x3d3)+'ns'][ck(0x463)+'h']+(ck(0x1a6)+ck(0x303)):'';return a[ck(0x36c)](''+await applyFont(name,ck(0x2c1)+ck(0x486)+ck(0x239)+ck(0x175))+am+'\x20'+ap+'\x0a\x0a'+(ck(0x1ab)+ck(0x396)+ck(0x2f1)+'\x20'+escapeHtml(ao)+'\x0a\x0a')+(ck(0x2dc)+ck(0x285)+ck(0x11c)+ck(0x1eb)+escapeHtml(an)),{'parse_mode':ck(0x3ef),'disable_web_page_preview':!![]});}catch(ay){return error(ck(0x246)+ck(0x15b)+ck(0x236)+ck(0x1be)+':\x20'+ay[ck(0x199)+'ge'],ay),a[ck(0x36c)](await applyFont(name,ck(0x491)+ck(0x172)+ck(0x378)+ck(0x24a)+ck(0x430)+ay[ck(0x199)+'ge']+'\x0a\x0a'+(ck(0x4b0)+ck(0x388)+ck(0x383)+ck(0x341)+ck(0x2e2)+ck(0x383)+'2\x0a')+(ck(0x368)+ck(0x42f)+ck(0x297))+(ck(0x368)+ck(0x42f)+ck(0x1c7))+(ck(0x3d3)+ck(0x355)+'\x0a')+(ck(0x499)+ck(0x38b)+ck(0x406)+ck(0x12b)+ck(0x1de)+ck(0x316))),{'parse_mode':ck(0x3ef)});}}if(h===ck(0x42c)+ck(0x383)){const az=b[ck(0x207)](h[ck(0x463)+'h'])[ck(0x18c)]()[ck(0x291)](',')[ck(0x189)](aB=>aB[ck(0x18c)]())[ck(0x34c)+'r'](Boolean);if(!az[ck(0x463)+'h'])return a[ck(0x36c)](await applyFont(name,ck(0x41b)+ck(0x377)+ck(0x33f)+ck(0x17f)+ck(0x4a4)+ck(0x376)+ck(0x204)));let aA=d;if(c===ck(0x2f6)+'te'){const aB=await getDefault();if(!aB)return a[ck(0x36c)](await applyFont(name,ck(0x4ad)+ck(0x1e5)+ck(0x25d)+ck(0x2a4)));const aC=await getConnection(aB);if(!aC)return a[ck(0x36c)](await applyFont(name,ck(0x379)+ck(0x245)+aB+(ck(0x2ad)+ck(0x1a4)+'d.')));const aD=delFilter(aA,az);let aE='';aD[ck(0x1d8)+'ed'][ck(0x463)+'h']>0x0&&(aE+=ck(0x299)+ck(0x31a)+'\x20'+aD[ck(0x1d8)+'ed'][ck(0x1ba)](',\x20')+'\x0a');if(aD[ck(0x44d)+ck(0x309)][ck(0x463)+'h']>0x0){aE+=ck(0x3ca)+ck(0x1a4)+ck(0x26b)+aD[ck(0x44d)+ck(0x309)][ck(0x1ba)](',\x20')+'\x0a';for(const aG of aD[ck(0x44d)+ck(0x309)]){aD[ck(0x49b)+ck(0x35c)+'s'][ck(0x28c)](aG)&&(aE+=ck(0x49d)+ck(0x29b)+ck(0x3db)+'\x20'+aD[ck(0x49b)+ck(0x35c)+'s'][ck(0x48f)](aG)+'?\x0a');}}let aF=ck(0x1b3)+aA;try{const aH=await botApi[ck(0x402)+'at'](aA);aF=ck(0x356)+escapeHtml(aH[ck(0x3c6)])+ck(0x167);}catch(aI){}return a[ck(0x36c)](''+await applyFont(name,ck(0x246)+ck(0x1ac)+ck(0x49c)+ck(0x17b)+ck(0x431)+'r\x20')+aF+await applyFont(name,':\x0a')+aE,{'parse_mode':ck(0x3ef)});}else{const aJ=delFilter(d,az);let aK='';aJ[ck(0x1d8)+'ed'][ck(0x463)+'h']>0x0&&(aK+=ck(0x299)+ck(0x31a)+'\x20'+aJ[ck(0x1d8)+'ed'][ck(0x1ba)](',\x20')+'\x0a');if(aJ[ck(0x44d)+ck(0x309)][ck(0x463)+'h']>0x0){aK+=ck(0x3ca)+ck(0x1a4)+ck(0x26b)+aJ[ck(0x44d)+ck(0x309)][ck(0x1ba)](',\x20')+'\x0a';for(const aL of aJ[ck(0x44d)+ck(0x309)]){aJ[ck(0x49b)+ck(0x35c)+'s'][ck(0x28c)](aL)&&(aK+=ck(0x49d)+ck(0x29b)+ck(0x3db)+'\x20'+aJ[ck(0x49b)+ck(0x35c)+'s'][ck(0x48f)](aL)+'?\x0a');}}return a[ck(0x36c)](aK||ck(0x4ad)+ck(0x34c)+ck(0x420)+ck(0x494)+'.');}}if(h===ck(0x2bc)+ck(0x34c)+'r'){let aM=d;if(c===ck(0x2f6)+'te'){const aO=await getDefault();if(!aO)return a[ck(0x36c)](await applyFont(name,ck(0x4ad)+ck(0x1e5)+ck(0x25d)+ck(0x2a4)));const aP=await getConnection(aO);if(!aP)return a[ck(0x36c)](await applyFont(name,ck(0x379)+ck(0x245)+aO+(ck(0x2ad)+ck(0x1a4)+'d.')));aM=aP;}const aN=await generateFilterListPage(aM,0x1);return a[ck(0x36c)](aN[ck(0x36a)],{...aN});}if(h===ck(0x369)+ck(0x3d3)+'ns'){let aQ=d;if(c===ck(0x2f6)+'te'){const aS=await getDefault();if(!aS)return a[ck(0x36c)](await applyFont(name,ck(0x4ad)+ck(0x1e5)+ck(0x25d)+ck(0x2a4)));const aT=await getConnection(aS);if(!aT)return a[ck(0x36c)](await applyFont(name,ck(0x379)+ck(0x245)+aS+(ck(0x2ad)+ck(0x1a4)+'d.')));aQ=aT;}const aR=await generateButtonListPage(aQ,0x1);return a[ck(0x36c)](aR[ck(0x36a)],{...aR});}if(h===ck(0x37b)+ck(0x29d)+'se'){const aU=b[ck(0x207)](h[ck(0x463)+'h'])[ck(0x18c)]();if(!aU)return a[ck(0x36c)](await applyFont(name,ck(0x41b)+ck(0x377)+ck(0x18d)+ck(0x2e8)+ck(0x39e)+ck(0x46b)));let aV=d;if(c===ck(0x2f6)+'te'){const aY=await getDefault();if(!aY)return a[ck(0x36c)](await applyFont(name,ck(0x4ad)+ck(0x1e5)+ck(0x25d)+ck(0x2a4)));const aZ=await getConnection(aY);if(!aZ)return a[ck(0x36c)](await applyFont(name,ck(0x379)+ck(0x245)+aY+(ck(0x2ad)+ck(0x1a4)+'d.')));aV=aZ;}const aW=delResponse(aV,aU);let aX=ck(0x1b3)+aV;try{if(aV!==d){const b0=await botApi[ck(0x402)+'at'](aV);aX=ck(0x356)+escapeHtml(b0[ck(0x3c6)]||ck(0x2f9)+'wn')+ck(0x167);}else aX=ck(0x160)+ck(0x2d0);}catch(b1){}if(aW[ck(0x12a)+'s']===ck(0x354)+ck(0x42d)){let b2=ck(0x3a5)+ck(0x41f)+ck(0x212)+ck(0x181)+ck(0x429);return aW[ck(0x259)+'es'][ck(0x374)+'ch']((b3,b4)=>{const cm=ck,b5=b3[cm(0x1f0)+cm(0x34f)+'xt'][cm(0x463)+'h']>0x32?b3[cm(0x1f0)+cm(0x34f)+'xt'][cm(0x332)+cm(0x2af)](0x0,0x2f)+cm(0x176):b3[cm(0x1f0)+cm(0x34f)+'xt'];b2+=b4+0x1+(cm(0x1f7)+cm(0x28e))+b3[cm(0x34c)+cm(0x2b0)]+cm(0x32a)+b5+'\x22\x0a';}),b2+=ck(0x400)+ck(0x4a2)+ck(0x475)+ck(0x31b)+ck(0x249)+ck(0x237)+ck(0x1f0)+ck(0x2e6)+ck(0x1dd)+ck(0x310),pendingAdminActions[ck(0x241)](f,{'type':ck(0x180)+ck(0x12c)+ck(0x18d)+ck(0x141)+ck(0x3be)+'t','chatId':aV,'matches':aW[ck(0x259)+'es'],'ts':Date[ck(0x47e)]()}),a[ck(0x36c)](b2,{'reply_markup':generateCancelKeyboard(aV)});}return a[ck(0x36c)](''+await applyFont(name,ck(0x31d)+ck(0x23f)+'\x20')+aX+await applyFont(name,':\x0a')+aW[ck(0x199)+'ge'],{'parse_mode':aW[ck(0x164)+ck(0x448)]||ck(0x3ef)});}if(h[ck(0x13d)+ck(0x185)](ck(0x37b)+ck(0x29d)+ck(0x257))&&!isNaN(parseInt(b[ck(0x291)]('\x20')[0x1]))){const b3=parseInt(b[ck(0x291)]('\x20')[0x1]),b4=pendingAdminActions[ck(0x48f)](f);if(!b4||b4[ck(0x213)]!==ck(0x180)+ck(0x12c)+ck(0x18d)+ck(0x141)+ck(0x3be)+'t'||!b4[ck(0x259)+'es']||!Array[ck(0x11f)+'ay'](b4[ck(0x259)+'es']))return pendingAdminActions[ck(0x1d8)+'e'](f),a[ck(0x36c)](ck(0x4ad)+ck(0x327)+ck(0x485)+ck(0x20b)+ck(0x29d)+ck(0x27b)+ck(0x361)+ck(0x3b9)+ck(0x470)+ck(0x29a)+ck(0x375)+ck(0x450)+ck(0x187)+ck(0x138)+ck(0x351)+ck(0x1d5)+ck(0x37b)+ck(0x29d)+ck(0x2f4)+ck(0x4a7),{'reply_markup':generateCancelKeyboard(b4?.[ck(0x3a2)+'d']||d)});if(b3<0x1||b3>b4[ck(0x259)+'es'][ck(0x463)+'h'])return a[ck(0x36c)](ck(0x188)+ck(0x240)+ck(0x3be)+ck(0x415)+ck(0x1fe)+ck(0x445)+ck(0x271)+ck(0x2d8)+ck(0x4a5),{'reply_markup':generateCancelKeyboard(b4[ck(0x3a2)+'d'])});const b5=b4[ck(0x259)+'es'][b3-0x1],b6=getChatFilters(b4[ck(0x3a2)+'d'])[ck(0x48f)](b5[ck(0x34c)+ck(0x2b0)]);b6[ck(0x1f0)+ck(0x288)][ck(0x2d5)+'e'](b5[ck(0x1f0)+ck(0x19d)+ck(0x261)],0x1);const b7=b4[ck(0x3a2)+'d']+'_'+b5[ck(0x34c)+ck(0x2b0)];return userResponseIndex[ck(0x1d8)+'e'](b7),markFiltersChanged(),markUserIndexChanged(),pendingAdminActions[ck(0x1d8)+'e'](f),a[ck(0x36c)](ck(0x438)+ck(0x42f)+ck(0x21a)+ck(0x219)+ck(0x168)+ck(0x383)+'\x20\x22'+b5[ck(0x34c)+ck(0x2b0)]+'\x22.');}if(h===ck(0x42c)+ck(0x3d3)+'n'){const b8=b[ck(0x207)](h[ck(0x463)+'h'])[ck(0x18c)]();if(!b8)return a[ck(0x36c)](await applyFont(name,ck(0x41b)+ck(0x377)+ck(0x449)+ck(0x3f1)+ck(0x1c0)+ck(0x394)));let b9=d;if(c===ck(0x2f6)+'te'){const be=await getDefault();if(!be)return a[ck(0x36c)](await applyFont(name,ck(0x4ad)+ck(0x1e5)+ck(0x25d)+ck(0x2a4)));const bf=await getConnection(be);if(!bf)return a[ck(0x36c)](await applyFont(name,ck(0x379)+ck(0x245)+be+(ck(0x2ad)+ck(0x1a4)+'d.')));b9=bf;}const ba=listButtons(b9),bb=ba[ck(0x1b6)](bg=>bg[ck(0x41e)]===b8);if(!bb){let bg='';for(const bh of ba){const bi=levenshteinDistance(b8,bh[ck(0x41e)]);bi<=LEVENSHTEIN_DISTANCE_THRESHOLD&&(bg+=ck(0x49d)+ck(0x29b)+ck(0x3db)+'\x20'+bh[ck(0x41e)]+'?\x0a');}return a[ck(0x36c)](ck(0x386)+ck(0x2c7)+ck(0x44c)+ck(0x469)+(bg||ck(0x1f9)+ck(0x45f)+ck(0x1a6)+ck(0x1ce)+ck(0x2b3)),{'reply_markup':generateCancelKeyboard(b9)});}const bc=[],bd=getChatFilters(b9);for(const [bj,bk]of bd[ck(0x229)+'es']()){if(bk&&!bk[ck(0x268)+ck(0x211)+'f']){const bl=bk[ck(0x3d3)+'ns']?.[ck(0x1b6)](bm=>bm[ck(0x41e)]===b8);bl&&bc[ck(0x346)](bj);}}pendingAdminActions[ck(0x241)](f,{'type':ck(0x180)+ck(0x12c)+ck(0x449)+ck(0x472)+ck(0x2c2),'chatId':b9,'buttonName':b8,'matches':bc,'ts':Date[ck(0x47e)]()});if(bc[ck(0x463)+'h']===0x0)return pendingAdminActions[ck(0x1d8)+'e'](f),a[ck(0x36c)](ck(0x2aa)+ck(0x23e)+ck(0x1d4)+ck(0x391)+ck(0x437)+ck(0x247)+ck(0x1a4)+ck(0x175)+ck(0x47a)+ck(0x383)+ck(0x2fb)+ck(0x22b)+ck(0x30f)+ck(0x35a)+ck(0x318),{'reply_markup':generateCancelKeyboard(b9)});else{if(bc[ck(0x463)+'h']===0x1){const bm=delButton(b9,b8,bc[0x0]);bm[ck(0x1d8)+'ed']?await a[ck(0x36c)](ck(0x2e3)+ck(0x30b)+ck(0x38c)+ck(0x497)+ck(0x2d2)+ck(0x4a6)+bc[0x0]+'\x22.'):await a[ck(0x36c)](ck(0x15c)+ck(0x22d)+ck(0x1dd)+ck(0x22e)+ck(0x1c0)+'.'),pendingAdminActions[ck(0x1d8)+'e'](f);}else{let bn=ck(0x437)+ck(0x418)+ck(0x325)+ck(0x2fd)+ck(0x331)+ck(0x34c)+ck(0x270);bc[ck(0x374)+'ch']((bo,bp)=>{bn+=bp+0x1+'.\x20'+bo+'\x0a';}),bn+=ck(0x400)+ck(0x4a2)+ck(0x475)+ck(0x31b)+ck(0x249)+ck(0x237)+ck(0x34c)+ck(0x148)+ck(0x1d8)+ck(0x1cb)+'m.',await a[ck(0x36c)](bn,{'reply_markup':generateCancelKeyboard(b9)});}}}if(h[ck(0x13d)+ck(0x185)](ck(0x42c)+ck(0x3d3)+'n\x20')&&!isNaN(parseInt(b[ck(0x291)]('\x20')[0x1]))){const bo=parseInt(b[ck(0x291)]('\x20')[0x1]),bp=pendingAdminActions[ck(0x48f)](f);if(!bp||bp[ck(0x213)]!==ck(0x180)+ck(0x12c)+ck(0x449)+ck(0x472)+ck(0x2c2)||!bp[ck(0x259)+'es']||!Array[ck(0x11f)+'ay'](bp[ck(0x259)+'es']))return pendingAdminActions[ck(0x1d8)+'e'](f),a[ck(0x36c)](ck(0x4ad)+ck(0x327)+ck(0x485)+ck(0x12f)+ck(0x1c0)+ck(0x43d)+ck(0x16a)+ck(0x140)+ck(0x2bd)+ck(0x14b)+ck(0x3e8)+ck(0x21a)+ck(0x415)+ck(0x35d)+ck(0x2a0)+ck(0x46c)+ck(0x3c3)+ck(0x2ab)+ck(0x242)+'].',{'reply_markup':generateCancelKeyboard(bp?.[ck(0x3a2)+'d']||d)});if(bo<0x1||bo>bp[ck(0x259)+'es'][ck(0x463)+'h'])return a[ck(0x36c)](ck(0x188)+ck(0x240)+ck(0x3be)+ck(0x415)+ck(0x1fe)+ck(0x445)+ck(0x271)+ck(0x2d8)+ck(0x4a5),{'reply_markup':generateCancelKeyboard(bp[ck(0x3a2)+'d'])});const bq=bp[ck(0x259)+'es'][bo-0x1],br=delButton(bp[ck(0x3a2)+'d'],bp[ck(0x3d3)+ck(0x33b)],bq);return pendingAdminActions[ck(0x1d8)+'e'](f),br[ck(0x1d8)+'ed']?a[ck(0x36c)](ck(0x2e3)+ck(0x30b)+ck(0x38c)+ck(0x497)+ck(0x2d2)+ck(0x4a6)+bq+'\x22.'):a[ck(0x36c)](ck(0x15c)+ck(0x22d)+ck(0x1dd)+ck(0x22e)+ck(0x1c0)+'.');}if(c!==ck(0x2f6)+'te'&&b){const bs=getChatFilters(d),bt=matchFilter(bs,b);if(bt){const bu=bs[ck(0x48f)](bt);if(bu?.[ck(0x1f0)+ck(0x288)]?.[ck(0x463)+'h']>0x0){const bv=d+'_'+bt;let bw=userResponseIndex[ck(0x48f)](bv)||0x0;const bx=bu[ck(0x1f0)+ck(0x288)][bw];if(bx){const by=formatTextWithEntities(bx[ck(0x36a)],bx[ck(0x414)+ck(0x2fa)]),bz={'parse_mode':ck(0x3ef),'disable_web_page_preview':!![]};if(bu[ck(0x3d3)+'ns']?.[ck(0x463)+'h']>0x0){const bA=new InlineKeyboard();let bB=0x0;if(bu[ck(0x348)+'t']&&bu[ck(0x348)+'t'][ck(0x463)+'h']>0x0)for(const bC of bu[ck(0x348)+'t']){const bD=[];for(let bE=0x0;bE<bC;bE++){if(bB<bu[ck(0x3d3)+'ns'][ck(0x463)+'h']){const bF=bu[ck(0x3d3)+'ns'][bB];bD[ck(0x346)](InlineKeyboard[ck(0x145)](bF[ck(0x41e)],bF[ck(0x145)])),bB++;}}bD[ck(0x463)+'h']>0x0&&bA[ck(0x382)](...bD);}else for(const bG of bu[ck(0x3d3)+'ns']){bA[ck(0x145)](bG[ck(0x41e)],bG[ck(0x145)]),bB++;if(bB%0x8===0x0)bA[ck(0x382)]();}bz[ck(0x36c)+ck(0x3ce)+'up']=bA;}await a[ck(0x36c)](by,bz),userResponseIndex[ck(0x241)](bv,(bw+0x1)%bu[ck(0x1f0)+ck(0x288)][ck(0x463)+'h']),markUserIndexChanged();}}}}}export async function onCallbackQuery(a){const cn=a0bI,b=a[cn(0x1db)+cn(0x42b)+cn(0x1e8)]?.[cn(0x347)],c=a[cn(0x3f7)]?.['id'];if(b?.[cn(0x13d)+cn(0x185)](CALLBACK_PREFIX)){const d=b[cn(0x291)]('::'),f=d[0x1],g=Number(d[0x2]),h=Number(d[0x3]);if(isNaN(g)||isNaN(h)){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x3c5)+cn(0x1af)+cn(0x287),'show_alert':!![]});return;}if(!isAdmin(a)){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x1a2)+cn(0x1ea)+cn(0x2eb)+'d.','show_alert':!![]});return;}if(f===cn(0x33f)+'p'||f===cn(0x2a3)){const m=f===cn(0x33f)+'p'?await generateFilterListPage(g,h):await generateButtonListPage(g,h);try{await a[cn(0x123)+cn(0x337)+cn(0x315)](m[cn(0x36a)],{...m}),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]();}catch(n){!n[cn(0x279)+cn(0x3ed)+'n']?.[cn(0x3c0)+cn(0x284)](cn(0x199)+cn(0x330)+cn(0x200)+cn(0x444)+cn(0x1e4))?(error(cn(0x1c2)+cn(0x3b0)+cn(0x474)+'\x20'+n[cn(0x199)+'ge'],n),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x1f1)+':\x20'+n[cn(0x199)+'ge'],'show_alert':!![]})):await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]();}return;}if(f===cn(0x21c)){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]();return;}const i=d[0x2],j=pendingActions[cn(0x48f)](i);if(!j||j['ts']+PENDING_ACTION_TTL_MS<Date[cn(0x47e)]()){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x19c)+cn(0x202)+cn(0x393)+'d.','show_alert':!![]});return;}if(!isAdmin(a)){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x1a2)+cn(0x1ea)+cn(0x2eb)+'d.','show_alert':!![]});return;}pendingActions[cn(0x1d8)+'e'](i);const {payload:k}=j,l=k[cn(0x3a2)+'d'];try{switch(f){case cn(0x3ff)+'t':{if(k[cn(0x22f)]===cn(0x1d8)+cn(0x4aa))setFilter(l,k[cn(0x164)+cn(0x210)+cn(0x424)][cn(0x34c)+cn(0x2b0)+'s'],k[cn(0x164)+cn(0x210)+cn(0x424)][cn(0x1f0)+cn(0x288)],k[cn(0x164)+cn(0x210)+cn(0x424)][cn(0x3d3)+'ns']),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x2c1)+cn(0x439)+cn(0x1e6)+cn(0x318)}),await a[cn(0x123)+cn(0x337)+cn(0x315)](await applyFont(name,cn(0x27f)+cn(0x37c)+cn(0x3b7)+cn(0x3ad)+l));else{if(k[cn(0x22f)]===cn(0x2cf)+cn(0x29d)+'se'){let o=addResponsesOnly(l,k[cn(0x164)+cn(0x210)+cn(0x424)][cn(0x34c)+cn(0x2b0)+'s'][0x0],k[cn(0x164)+cn(0x210)+cn(0x424)][cn(0x1f0)+cn(0x288)]);await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x1bd)+cn(0x496)+o+(cn(0x163)+cn(0x1fb)+cn(0x2cd))}),await a[cn(0x123)+cn(0x337)+cn(0x315)](await applyFont(name,cn(0x1bd)+cn(0x2ac)+cn(0x481)+l));}}break;}default:await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x2f9)+cn(0x3fa)+cn(0x3e1),'show_alert':!![]});}}catch(p){error(cn(0x1c2)+cn(0x3b0)+cn(0x474)+'\x20'+p[cn(0x199)+'ge'],p),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x1f1)+':\x20'+p[cn(0x199)+'ge'],'show_alert':!![]});}return;}if(b?.[cn(0x13d)+cn(0x185)](ADMIN_CALLBACK_PREFIX)){const q=b[cn(0x291)]('::'),r=q[0x1],s=Number(q[0x2]);if(isNaN(s)){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x3c5)+cn(0x25b)+cn(0x495)+'.','show_alert':!![]});return;}if(!isAdmin(a)){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x1a2)+cn(0x1ea)+cn(0x2eb)+'d.','show_alert':!![]});return;}try{switch(r){case cn(0x178):{c&&pendingAdminActions[cn(0x1d8)+'e'](c);const t=generateAdminPanelKeyboard(s);let u=cn(0x1b3)+s;try{const w=await botApi[cn(0x402)+'at'](s);u=cn(0x356)+escapeHtml(w[cn(0x3c6)]||cn(0x2f9)+'wn')+cn(0x167);}catch(x){}const v=''+await applyFont(name,cn(0x2fe)+cn(0x221))+u;await a[cn(0x123)+cn(0x337)+cn(0x315)](v,{'reply_markup':t,'parse_mode':cn(0x3ef)}),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]();break;}case cn(0x34a)+cn(0x383)+'s':{const y=await generateFilterListPage(s,0x1);await a[cn(0x123)+cn(0x337)+cn(0x315)](y[cn(0x36a)],{...y}),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]();break;}case cn(0x243)+cn(0x1c0)+'s':{const z=await generateButtonListPage(s,0x1);await a[cn(0x123)+cn(0x337)+cn(0x315)](z[cn(0x36a)],{...z}),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]();break;}case cn(0x362)+cn(0x39a)+cn(0x383):{if(!c){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x209)+cn(0x146)+cn(0x417)+'.','show_alert':!![]});return;}pendingAdminActions[cn(0x241)](c,{'type':cn(0x1d8)+cn(0x2d1)+cn(0x442)+cn(0x2f8),'chatId':s,'ts':Date[cn(0x47e)]()}),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x24d)+cn(0x258)+cn(0x38c)+'.','show_alert':!![]}),await a[cn(0x36c)](''+await applyFont(name,cn(0x404)+cn(0x34c)+cn(0x33d)+cn(0x1ef)+cn(0x152)+cn(0x150)+cn(0x1e3)+cn(0x221)+cn(0x1b3))+s,{'reply_markup':generateCancelKeyboard(s)});break;}case cn(0x362)+cn(0x205)+cn(0x29d)+'se':{if(!c){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x209)+cn(0x146)+cn(0x417)+'.','show_alert':!![]});return;}pendingAdminActions[cn(0x241)](c,{'type':cn(0x1d8)+cn(0x156)+cn(0x42f)+cn(0x3b6)+'pt','chatId':s,'ts':Date[cn(0x47e)]()}),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x24d)+cn(0x258)+cn(0x38c)+'.','show_alert':!![]}),await a[cn(0x36c)](''+await applyFont(name,cn(0x404)+cn(0x34e)+cn(0x163)+cn(0x2e8)+cn(0x254)+cn(0x302)+'D\x20')+s,{'reply_markup':generateCancelKeyboard(s)});break;}case cn(0x362)+cn(0x39a)+cn(0x3d3)+'n':{if(!c){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x209)+cn(0x146)+cn(0x417)+'.','show_alert':!![]});return;}pendingAdminActions[cn(0x241)](c,{'type':cn(0x1d8)+cn(0x158)+cn(0x3f3)+cn(0x2f8),'chatId':s,'ts':Date[cn(0x47e)]()}),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x24d)+cn(0x258)+cn(0x38c)+'.','show_alert':!![]}),await a[cn(0x36c)](''+await applyFont(name,cn(0x404)+cn(0x3d3)+cn(0x490)+cn(0x142)+cn(0x301))+s,{'reply_markup':generateCancelKeyboard(s)});break;}case cn(0x362)+cn(0x45b)+cn(0x29d)+'se':{if(!c){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x209)+cn(0x146)+cn(0x417)+'.','show_alert':!![]});return;}pendingAdminActions[cn(0x241)](c,{'type':cn(0x2cf)+cn(0x29d)+cn(0x462)+cn(0x21e),'chatId':s,'ts':Date[cn(0x47e)]()}),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x24d)+cn(0x413)+cn(0x19a)+cn(0x285)+cn(0x2f3),'show_alert':!![]}),await a[cn(0x36c)](''+await applyFont(name,cn(0x404)+cn(0x2ff)+cn(0x471)+cn(0x225)+cn(0x255)+cn(0x4b5)+cn(0x2f5)+cn(0x35e)+cn(0x1ec)+cn(0x285)+cn(0x313)+cn(0x447)+'D\x20')+s,{'reply_markup':generateCancelKeyboard(s)});break;}case cn(0x362)+cn(0x23d)+cn(0x1c0):{if(!c){await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x209)+cn(0x146)+cn(0x417)+'.','show_alert':!![]});return;}pendingAdminActions[cn(0x241)](c,{'type':cn(0x1a7)+cn(0x1c0)+cn(0x3b6)+'pt','chatId':s,'ts':Date[cn(0x47e)]()}),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x24d)+cn(0x413)+cn(0x286)+cn(0x457)+'.','show_alert':!![]}),await a[cn(0x36c)](''+await applyFont(name,cn(0x404)+cn(0x2ff)+cn(0x471)+cn(0x225)+cn(0x255)+cn(0x2b5)+cn(0x426)+cn(0x47f)+cn(0x1c0)+cn(0x365)+cn(0x30d)+cn(0x2ca)+cn(0x367)+cn(0x4a9)+cn(0x19f)+cn(0x437)+cn(0x22a)+cn(0x1cf)+cn(0x3a9)+cn(0x16f)+cn(0x41a)+cn(0x3e7)+cn(0x30e)+cn(0x137)+cn(0x466)+cn(0x206)+cn(0x30c)+cn(0x3d8)+cn(0x1b3))+s,{'reply_markup':generateCancelKeyboard(s)});break;}case cn(0x2dd)+'ss':{await a[cn(0x123)+cn(0x337)+cn(0x2d6)+cn(0x2a5)+'up']({}),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x2c9)+cn(0x2dd)+cn(0x49f)});c&&pendingAdminActions[cn(0x1d8)+'e'](c);break;}default:await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x2f9)+cn(0x3fa)+cn(0x3e1),'show_alert':!![]});}}catch(A){error(cn(0x2fe)+cn(0x2d4)+cn(0x47d)+cn(0x1be)+':\x20'+A[cn(0x199)+'ge'],A),await a[cn(0x45d)+cn(0x4ab)+cn(0x298)+cn(0x401)]({'text':cn(0x1f1)+':\x20'+A[cn(0x199)+'ge'],'show_alert':!![]});}}}async function onShutdown(){const co=a0bI;info(co(0x1b7)+co(0x322)+co(0x238)+co(0x3fd)+co(0x14d)),clearTimeout(filterSaveTimer),clearTimeout(userIndexSaveTimer);try{await Promise[co(0x326)]([saveAllFiltersToDB(),saveUserResponseIndexesToDB()]),info(co(0x16e)+co(0x37d)+co(0x4b4)+co(0x136)+co(0x12e));}catch(a){error(co(0x16e)+co(0x3ec)+co(0x474)+co(0x39b)+'s',a,a?.[co(0x41d)]);}}export async function initialize(a){const cp=a0bI;try{if(!a?.[cp(0x3ab)])throw new Error(cp(0x46d)+cp(0x1c5)+cp(0x26a)+cp(0x484)+'d.');botApi=a[cp(0x3ab)],await initDatabase(),await loadFiltersFromDB(),await loadUserResponseIndexesFromDB(),prunePendingInterval=setInterval(prunePendingTokens,0x3c*0x3c*0x3e8),a['on'](cp(0x199)+'ge',onMessage),a['on'](cp(0x1db)+cp(0x250)+cp(0x401),onCallbackQuery),process[cp(0x198)](cp(0x38e)+'T',onShutdown),process[cp(0x198)](cp(0x2e0)+'RM',onShutdown),info(cp(0x2c1)+cp(0x478)+version+(cp(0x265)+cp(0x251)+cp(0x318)));}catch(b){error(cp(0x384)+cp(0x34d)+cp(0x26b)+b[cp(0x199)+'ge']);throw b;}}
