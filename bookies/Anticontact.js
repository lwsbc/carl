const a0w=a0b;function a0a(){const D=['AwqGpsa','n25IEeXcza','mZiXEuDrAevl','yMvY','t1qGtLu','y2HHDf8','ywn0x3e','zwy9iNq','txv0zwq','x0vyueK','x0voqui','su5guKe','id8Gqu4','rvHju1q','x2nVzgu','ywDLx2K','Df9PzcW','ieLoveu','B250ywm','ywXS','ntKXnZi4mgr5yuv0qq','mtuYnZu1nZreCvPjBKq','kgnOyxq','vcbJAge','DgvKia','teuGsuy','AxnwywW','vxnLCG','txv0zsa','CNvU','yxrFAwq','tKDFu1u','igzVCIa','ifrjtuu','zwrFyxq','icaGifa','zNjVBq','zgvSzxq','rcbTzxm','ucWkica','u0Hpteq','q1jfqvq','cIaGica','Awn0q2G','BgvUz3q','x25HBwu','zgvZ','tf9nuW','uxvLDwu','CMvWzwe','q1rFru4','z3jVDxa','zxjYB3i','vcbpuIa','r01bsuW','Bgv0zsa','z2vFAwq','ignOyxq','rw1HAwW','icHJAge','wsblrvK','vuXuiem','y2HHDa','mti3ndzcwxjJve0','DgvZDa','u0vmrum','yxbP','icyGugG','q09ovee','su5trvi','AwnVBNq','DhLWzq','pc9HpG','CMvWBhK','ideW','mI4XlJe','zZOVl3u','CNjVCJO','igrLBgu','t05uqum','rsbuqui','tsbHBNq','C2vYp2K','BwvZC2e','rvnuqu0','pgeGAhi','x1riuKu','C3bSAxq','icaGy2G','ie5pvca','q1rjt04','v2fYBMK','qu5usum','DguGzxi','vuvticG','zu1LC3m','y3jLyxq','BM93','CM9YoIa','ihbYB2m','C1DPDgG','revmrvq','y2fWDgK','zxnZigu','zMLYC3q','tKDFufi','qw50Awm','Aw5JBhu','AxnFyM8','qujmruq','ruzjwa','ndC3mJe2mgn6vgLgrq','rKzjwa','C2fNzv8','ugHVBMu','Dwv1zsa','zdOG','teve','DxnLCM4','icaPoWO','yxrnzw0','x2LKid0','BMqVzgu','v0fstKK','ChvZAa','teWScIa','DhjPBq','ihvZzxi','ierfrKe','vvjsru4','uYbHBNq','BMCGC2u','zMfPBgu','zcKkica','rsbjtLq','tYbHBNq','CMvZDhi','mtuWntuWmLjjy2PotW','yw1L','nZC5mte2DNzQs1r3','tKDFvfq','ig1LC3m','icaGica','ywDL','uKLnqvi','u1rbtva','y291BNq','teLnsvq','rsbguK8','suDot1i','C3vWzxi','C3rHCNq','x2LKlca','kaOGica','CMvWBge','zcbguK8','v0HfuKu','ksbwquW','pYWGpYK','B25L','zxHLyW','Dgv4Da','uLLFtvm','mtCXnZu5mez3we1iDq','zMLSDgu','sfrnta','vf9usu0','r0vsie4','y2f0y2G'];a0a=function(){return D;};return a0a();}(function(a,b){const v=a0b,c=a();while(!![]){try{const d=parseInt(v(0x161))/0x1+parseInt(v(0x115))/0x2*(-parseInt(v(0xd8))/0x3)+-parseInt(v(0xea))/0x4+-parseInt(v(0xd0))/0x5+parseInt(v(0x15f))/0x6+parseInt(v(0xd7))/0x7*(parseInt(v(0x145))/0x8)+parseInt(v(0xeb))/0x9;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0xc7f92));import{getConfig}from'../bookieutils/config.js';import{error,info}from'../bookieutils/logger.js';import{db}from'../bookieutils/db.js';import{applyFont,registerModule}from'../bookieutils/helpeutils/fonthelp.js';import{parsePhoneNumberFromString}from'libphonenumber-js';export const name=a0w(0x140)+a0w(0xe8)+'t';export const version=a0w(0x121);registerModule(name);const COUNTRIES=['KE','US','GB','IN','NG','ZA','TZ','UG','RW','ET','SO','SD'],infractions={};let processing=![],lastProcessTime=0x0,globalBot=null;function containsEmail(a){const x=a0w;return/[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}/[x(0x116)](a);}function containsPhoneNumber(a){const y=a0w,b=/\b(?:(?:\+254|254)\d{9}|(?:07|01)\d{8})[\s()-.]*\b/g,c=a[y(0x170)+'ce'](/\r\n/g,'\x0a')[y(0x12d)]('\x0a');for(const d of c){const e=d[y(0x154)]();if(!e)continue;let f;while((f=b[y(0x176)](e))!==null){const g=f[0x0][y(0x170)+'ce'](/[^\d+]/g,'');if(g[y(0x102)+'h']<0x9||g[y(0x16d)+y(0x13a)]('+')&&g[y(0x102)+'h']<0xc)continue;for(const h of COUNTRIES){try{const i=parsePhoneNumberFromString(g,h);if(i?.[y(0xf0)+'id']()&&i[y(0x168)+'ry']==='KE')return!![];}catch{}}}}return![];}function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0xce;let f=c[d];if(a0b['zoDwZg']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='';for(let p=0x0,q,r,s=0x0;r=l['charAt'](s++);~r&&(q=p%0x4?q*0x40+r:r,p++%0x4)?n+=String['fromCharCode'](0xff&q>>(-0x2*p&0x6)):0x0){r=m['indexOf'](r);}for(let t=0x0,u=n['length'];t<u;t++){o+='%'+('00'+n['charCodeAt'](t)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0b['cJnrvq']=g,a=arguments,a0b['zoDwZg']=!![];}const h=c[0x0],i=d+h,j=a[i];return!j?(f=a0b['cJnrvq'](f),a[i]=f):f=j,f;},a0b(a,b);}async function initDatabase(){const z=a0w;await db[z(0x176)](z(0x100)+z(0xff)+z(0x126)+z(0xef)+z(0x12f)+z(0xe3)+z(0x158)+z(0x11c)+z(0xdc)+z(0x149)+z(0x16f)+z(0x12e)+z(0xf4)+z(0xe7)+z(0xd4)+z(0xda)+z(0x153)+z(0x164)+z(0x129)+z(0x10e)+z(0xe7)+z(0xd4)+z(0xda)+z(0x153)+z(0x164)+z(0x136)+z(0xf8)+z(0xf7)+z(0x167)+z(0x156)+z(0x113)+z(0x157)+z(0xd3)+z(0x12a)+z(0xfd)+z(0xf9)+z(0x166)+z(0x112)+z(0x111)+z(0xe6)+z(0x163)+z(0xe5)+z(0x15b)+z(0x14d)+'\x20\x20');}async function enqueueDeletion(a,b){const A=a0w;await db[A(0xf3)](A(0x11b)+A(0x10b)+A(0x16b)+A(0x15c)+A(0x15d)+A(0x11c)+A(0xdc)+A(0x149)+A(0xec)+A(0x16e)+A(0x129)+A(0x10e)+A(0x173)+A(0x134)+A(0x174),a,b),processQueue();}async function processQueue(){const B=a0w,a=Date[B(0x137)](),{QUEUE_COOLDOWN_MS:QUEUE_COOLDOWN_MS=0xbb8}=getConfig()[B(0x132)+B(0x125)+'T'];if(processing||a-lastProcessTime<QUEUE_COOLDOWN_MS||!globalBot)return;processing=!![],lastProcessTime=a;try{let b;while(b=await db[B(0xe9)](B(0x117)+B(0xed)+B(0xe6)+B(0x163)+B(0xe5)+B(0x171)+B(0x127)+B(0x11c)+B(0xdc)+B(0x149)+B(0x169)+B(0x120))){if(!b[B(0x102)+'h'])break;for(const c of b){try{await globalBot[B(0x118)][B(0xfb)+B(0x135)+B(0x165)](c[B(0xdb)+'id'],c[B(0x129)+B(0x10e)]);}catch(d){![0x190,0x194][B(0x141)+B(0x104)](d[B(0x10a)+B(0xe4)])&&error(name,B(0x106)+B(0x124)+B(0x133)+B(0x138)+d[B(0x129)+'ge']);}await db[B(0xf3)](B(0x13b)+B(0x16a)+B(0x127)+B(0x11c)+B(0xdc)+B(0x149)+B(0x172)+B(0x10f)+B(0x14f)+B(0xe2)+B(0xfc)+B(0x147)+B(0xd6)+'?',c[B(0xdb)+'id'],c[B(0x129)+B(0x10e)]),await new Promise(f=>setTimeout(f,0x32));}}}catch(f){error(name,B(0x106)+B(0x139)+B(0x13d)+B(0x123)+'\x20'+f[B(0x129)+'ge']);}finally{processing=![];}}export async function initialize(a){globalBot=a,await initDatabase(),processQueue();}export async function onMessage(a){const C=a0w,b=getConfig()[C(0x132)+C(0x125)+'T'],c=a[C(0x129)+'ge']?.[C(0xce)]??a[C(0x129)+'ge']?.[C(0x13c)+'on'];if(!c||a[C(0x114)][C(0x11d)]!==C(0x16c)+C(0x109)||a[C(0xfa)]?.[C(0x142)+'t'])return;const d=a[C(0x114)]['id'],f=a[C(0x129)+'ge'][C(0x129)+C(0x10e)],g=a[C(0xfa)]['id'];let h=![],i='';b[C(0x10c)+C(0xe0)+C(0x14b)]&&containsEmail(c)&&(h=!![],i=C(0x110));b[C(0x11a)+C(0x108)+C(0x143)]&&containsPhoneNumber(c)&&(h=!![],i=i?i+(C(0x119)+C(0x175)):C(0x148));if(!h)return;let j=![];try{await a[C(0xfb)+C(0x135)+C(0x165)](),j=!![];}catch(q){enqueueDeletion(d,f);}const k=Date[C(0x137)](),l=b[C(0xe1)+C(0x130)+C(0xdf)+C(0xcf)]||0x36ee80,m=b[C(0xe1)+C(0x130)+C(0x12c)+C(0xfe)]||0x2;infractions[g]=(infractions[g]||[])[C(0xd1)+'r'](r=>k-r<l),infractions[g][C(0x152)](k);if(infractions[g][C(0x102)+'h']>=m){try{await a[C(0x118)][C(0x15e)+C(0x101)+C(0x14e)+C(0xd9)](d,g,{'permissions':{'can_send_messages':![]}}),await info(name,C(0xde)+C(0x155)+'\x20'+g+(C(0xf6)+C(0x107)+C(0xee))+i);}catch(r){error(name,C(0xf2)+C(0x15a)+C(0x14a)+r[C(0x129)+'ge'],r);}return;}const n=a[C(0xfa)][C(0x14c)+C(0x160)]?'@'+a[C(0xfa)][C(0x14c)+C(0x160)]:C(0x12b)+C(0xdd)+C(0x122)+C(0x128)+'d='+g+'\x22>'+(a[C(0xfa)][C(0x13e)+C(0x103)]||C(0xf1))+C(0x11e),o=!a[C(0xfa)][C(0x14c)+C(0x160)],p=await applyFont(name,b[C(0x151)+C(0x13f)+C(0x144)]||'')+n+await applyFont(name,b[C(0x151)+C(0xf5)+C(0x146)]||'');try{const s=await a[C(0x11f)](p,{'parse_mode':o?C(0xd2):undefined}),t=b[C(0x151)+C(0x162)+C(0x105)]||0x493e0;setTimeout(()=>a[C(0x118)][C(0xfb)+C(0x135)+C(0x165)](d,s[C(0x129)+C(0x10e)])[C(0xd5)](()=>{}),t);}catch(u){error(name,C(0x131)+C(0x159)+C(0x150)+C(0x10d)+C(0x15a)+C(0x14a)+u[C(0x129)+'ge'],u);}}export async function onCallbackQuery(){}